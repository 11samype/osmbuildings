var OSMBuildings=function(){function f(a,b){var g=a[0]-b[0],e=a[1]-b[1];return g*g+e*e}function J(a){for(var b=0,g=0,e=0,d=a.length-3;e<d;e+=2)b+=a[e],g+=a[e+1];a=(a.length-2)/2;return[b/a<<0,g/a<<0]}function Ea(a){var b,g,e,d,f=0,j,h;j=0;for(h=a.length-3;j<h;j+=2)b=a[j],g=a[j+1],e=a[j+2],d=a[j+3],f+=b*d-e*g;if("CW"===(0<f/2?"CW":"CCW"))return a;b=[];for(g=a.length-2;0<=g;g-=2)b.push(a[g],a[g+1]);return b}var Fa=Fa||Array,Ga=Ga||Array,h=Math,Oa=h.exp,Pa=h.log,Qa=h.sin,Ra=h.cos,wa=h.tan,Sa=h.atan,
qa=h.min,xa=h.max,Ha=document,U,ca=function(a){var b,g,e;if(0===a.s)b=g=e=a.l;else{e=0.5>a.l?a.l*(1+a.s):a.l+a.s-a.l*a.s;var d=2*a.l-e;a.h/=360;b=V(d,e,a.h+1/3);g=V(d,e,a.h);e=V(d,e,a.h-1/3)}return new w(255*b<<0,255*g<<0,255*e<<0,a.a)},V=function(a,b,g){0>g&&(g+=1);1<g&&(g-=1);return g<1/6?a+6*(b-a)*g:0.5>g?b:g<2/3?a+6*(b-a)*(2/3-g):a},w=function(a,b,g,e){this.r=a;this.g=b;this.b=g;this.a=4>arguments.length?1:e},h=w.prototype;h.toString=function(){return"rgba("+[this.r<<0,this.g<<0,this.b<<0,this.a.toFixed(2)].join()+
")"};h.setLightness=function(a){var b=w.toHSLA(this);b.l*=a;b.l=Math.min(1,Math.max(0,b.l));return ca(b)};h.setAlpha=function(a){return new w(this.r,this.g,this.b,this.a*a)};w.parse=function(a){var b;a+="";if(~a.indexOf("#")&&(b=a.match(/^#?(\w{2})(\w{2})(\w{2})(\w{2})?$/)))return new w(parseInt(b[1],16),parseInt(b[2],16),parseInt(b[3],16),b[4]?parseInt(b[4],16)/255:1);if(b=a.match(/rgba?\((\d+)\D+(\d+)\D+(\d+)(\D+([\d.]+))?\)/))return new w(parseInt(b[1],10),parseInt(b[2],10),parseInt(b[3],10),b[4]?
parseFloat(b[5]):1);if(b=a.match(/hsla?\(([\d.]+)\D+([\d.]+)\D+([\d.]+)(\D+([\d.]+))?\)/))return ca({h:parseInt(b[1],10),s:parseFloat(b[2]),l:parseFloat(b[3]),a:b[4]?parseFloat(b[5]):1})};w.toHSLA=function(a){var b=a.r/255,g=a.g/255,e=a.b/255,d=Math.max(b,g,e),f=Math.min(b,g,e),j,h=(d+f)/2,t;if(d===f)j=f=0;else{t=d-f;f=0.5<h?t/(2-d-f):t/(d+f);switch(d){case b:j=(g-e)/t+(g<e?6:0);break;case g:j=(e-b)/t+2;break;case e:j=(b-g)/t+4}j/=6}return{h:360*j,s:f,l:h,a:a.a}};U=w;var Ia,h=Math,K=h.PI,r=h.sin,
x=h.cos,da=h.tan,ea=h.asin,fa=h.atan2,E=K/180,O=23.4397*E;Ia=function(a,b,g){g=E*-g;b*=E;a=a.valueOf()/864E5-0.5+2440588-2451545;var e=E*(357.5291+0.98560028*a),d=E*(1.9148*r(e)+0.02*r(2*e)+3E-4*r(3*e)),d=e+d+102.9372*E+K,e=ea(r(0)*x(O)+x(0)*r(O)*r(d)),d=fa(r(d)*x(O)-da(0)*r(O),x(d));g=E*(280.16+360.9856235*a)-g-d;return{altitude:ea(r(b)*r(e)+x(b)*x(e)*x(g)),azimuth:fa(r(g),x(g)*r(b)-da(e)*x(b))-K/2}};var Ja,F=function(a){var b=parseFloat(a);return~a.indexOf("m")?b<<0:~a.indexOf("yd")?b*Ta<<0:~a.indexOf("ft")?
b*ga<<0:~a.indexOf("'")?(a=a.split("'"),a[0]*ga+a[1]*Ua<<0):b<<0},u=function(a){a=a.toLowerCase();return"#"===a[0]?a:Va[a]||null},H=function(a){a=a.toLowerCase();return"#"===a[0]?a:Wa[Xa[a]||a]||null},Ka=function(a){return(a=a.tags)&&!a.landuse&&(a.building||a["building:part"])&&(!a.layer||0<=a.layer)},La=function(a){if(a){for(var b=[],g,e=0,d=a.length;e<d;e++)g=M[a[e]],b.push(g[0],g[1]);b[b.length-2]!==b[0]&&b[b.length-1]!==b[1]&&b.push(b[0],b[1]);if(!(8>b.length))return b}},ha=function(a){var b=
0,g=0;a.height&&(b=F(a.height));!b&&a["building:height"]&&(b=F(a["building:height"]));!b&&a.levels&&(b=a.levels*P<<0);!b&&a["building:levels"]&&(b=a["building:levels"]*P<<0);a.min_height&&(g=F(a.min_height));!g&&a["building:min_height"]&&(g=F(a["building:min_height"]));!g&&a.min_level&&(g=a.min_level*P<<0);!g&&a["building:min_level"]&&(g=a["building:min_level"]*P<<0);var e,d;a["building:material"]&&(e=H(a["building:material"]));a["building:facade:material"]&&(e=H(a["building:facade:material"]));a["building:cladding"]&&
(e=H(a["building:cladding"]));a["building:color"]&&(e=u(a["building:color"]));a["building:colour"]&&(e=u(a["building:colour"]));a["roof:material"]&&(d=H(a["roof:material"]));a["building:roof:material"]&&(d=H(a["building:roof:material"]));a["roof:color"]&&(d=u(a["roof:color"]));a["roof:colour"]&&(d=u(a["roof:colour"]));a["building:roof:color"]&&(d=u(a["building:roof:color"]));a["building:roof:colour"]&&(d=u(a["building:roof:colour"]));return{height:b,minHeight:g,wallColor:e,roofColor:d}},Ma=function(a,
b,g){a={id:a,footprint:Ea(g)};b.height&&(a.height=b.height);b.minHeight&&(a.minHeight=b.minHeight);b.wallColor&&(a.wallColor=b.wallColor);b.roofColor&&(a.roofColor=b.roofColor);Y.push(a)},Ta=0.9144,ga=0.3048,Ua=0.0254,P=3,Va={black:"#000000",white:"#ffffff",brown:"#8b4513",green:"#00ff7f",grey:"#bebebe",gray:"#bebebe",lightgrey:"#d3d3d3",lightgray:"#d3d3d3",yellow:"#ffff00",red:"#ff0000",blue:"#0000ff"},Xa={asphalt:"tar_paper",bitumen:"tar_paper",block:"stone",bricks:"brick",glas:"glass",glassfront:"glass",
grass:"plants",masonry:"stone",granite:"stone",panels:"panel",paving_stones:"stone",plastered:"plaster",rooftiles:"roof_tiles",roofingfelt:"tar_paper",sandstone:"stone",sheet:"canvas",sheets:"canvas",shingle:"tar_paper",shingles:"tar_paper",slates:"slate",steel:"metal",tar:"tar_paper",tent:"canvas",thatch:"plants",tile:"roof_tiles",tiles:"roof_tiles"},Wa={brick:"#cc7755",bronze:"#ffeecc",canvas:"#fff8f0",concrete:"#999999",copper:"#a0e0d0",glass:"#e8f8f8",gold:"#ffcc00",plants:"#009933",metal:"#aaaaaa",
panel:"#fff8f0",plaster:"#999999",roof_tiles:"#f08060",silver:"#cccccc",slate:"#666666",stone:"#996666",tar_paper:"#333333",wood:"#deb887"},M,Z,Y;Ja=function(a){M={};Z={};Y=[];for(var b,g=0,e=a.length;g<e;g++)switch(b=a[g],b.type){case "node":M[b.id]=[b.lat,b.lon];break;case "way":var d=void 0,f=void 0;Ka(b)?(d=ha(b.tags),(f=La(b.nodes))&&Ma(b.id,d,f)):(d=b.tags)&&(!d.highway&&!d.railway&&!d.landuse)&&(Z[b.id]=b);break;case "relation":var j=d=d=void 0,f=void 0;if(Ka(b)&&("multipolygon"===b.tags.type||
"building"===b.tags.type)){a:{for(var d=b.members,f=void 0,j=0,h=d.length;j<h;j++)if(f=d[j],"way"===f.type&&"outer"===f.role){d=f;break a}d=void 0}if(d&&(b=ha(b.tags),d=Z[d.ref]))if(j=ha(d.tags),f=La(d.nodes)){h=void 0;for(h in b)j[h]||(j[h]=b[h]);Ma(d.id,j,f)}}}return Y};var ia=Math.PI,Na=ia/2,Ya=ia/4,Za=180/ia,$a=256,ab="latitude",bb="longitude",h=function(){function a(y,a){var c={};y/=E;a/=E;c[ab]=0>=a?90:1<=a?-90:Za*(2*Sa(Oa(ia*(1-2*a)))-Na);c[bb]=360*(1===y?1:(y%1+1)%1)-180;return c}function b(a,
b){return a.replace(/\{ *([\w_]+) *\}/g,function(a,y){return b[y]||a})}function g(a,b){var c=new XMLHttpRequest;c.onreadystatechange=function(){4===c.readyState&&c.status&&!(200>c.status||299<c.status)&&b&&c.responseText&&b(JSON.parse(c.responseText))};c.open("GET",a);c.send(null);return c}function e(){ja.render();ra.render();d()}function d(){v.clearRect(0,0,t,z);if(!(Q<F||ka)){var a,b,c,g,d,e,ya,W,l,m=ra.MAX_HEIGHT,n=[la+I,ma+A],R,q,k,s,X,p;C.renderItems.sort(function(a,y){return f(y.center,n)/y.height-
f(a.center,n)/a.height});a=0;for(b=C.renderItems.length;a<b;a++)if(d=C.renderItems[a],!(d.height<=m)){q=!1;e=d.footprint;R=[];c=0;for(g=e.length-1;c<g;c+=2)R[c]=W=e[c]-I,R[c+1]=l=e[c+1]-A,q||(q=0<W&&W<t&&0<l&&l<z);if(q){c=1>d.scale?d.height*d.scale:d.height;e=$/($-c);d.minHeight&&(c=1>d.scale?d.minHeight*d.scale:d.minHeight,ya=$/($-c));W=[];c=0;for(g=R.length-3;c<g;c+=2)l=R[c],k=R[c+1],q=R[c+2],s=R[c+3],X=j(l,k,e),p=j(q,s,e),d.minHeight&&(k=j(l,k,ya),s=j(q,s,ya),l=k.x,k=k.y,q=s.x,s=s.y),(q-l)*(X.y-
k)>(X.x-l)*(s-k)&&(v.fillStyle=l<q&&k<s||l>q&&k>s?d.altColor||na:d.wallColor||H,h([q,s,l,k,X.x,X.y,p.x,p.y])),W[c]=X.x,W[c+1]=X.y;v.fillStyle=d.roofColor||oa;v.strokeStyle=d.altColor||na;h(W,!0)}}}}function h(a,b){if(a.length){v.beginPath();v.moveTo(a[0],a[1]);for(var c=2,d=a.length;c<d;c+=2)v.lineTo(a[c],a[c+1]);v.closePath();b&&v.stroke();v.fill()}}function j(a,b,c){return{x:(a-la)*c+la<<0,y:(b-ma)*c+ma<<0}}function r(a){Q=a;E=$a<<Q;a=Q;var b=F,c=P;a=qa(xa(a,b),c);N=1-qa(xa(0+0.3*((a-b)/(c-b)),
0),0.3);H=B.setAlpha(N)+"";na=u.setAlpha(N)+"";oa=aa.setAlpha(N)+""}var t=0,z=0,w=0,x=0,I=0,A=0,Q,E,v,B=new U(200,190,180),u=B.setLightness(0.8),aa=B.setLightness(1.2),H=B+"",na=u+"",oa=aa+"",O,N=1,F=15,P=20,V,la,ma,$,ka,K=new Date,ba={},M={add:function(a,b){ba[a]={data:b,time:Date.now()}},get:function(a){return ba[a]&&ba[a].data},purge:function(){K.setMinutes(K.getMinutes()-5);for(var a in ba)ba[a].time<K&&delete ba[a]}},C,ha=function(a){return function(b){Y(b,a)}},Y=function(a,b){if(a){var c;if("FeatureCollection"===
a.type){c=a.features;var d,g,e,f,h=[],l,m,n,j,q,k,s,p;d=0;for(g=c.length;d<g;d++)if(l=c[d],"Feature"===l.type&&(m=l.geometry,l=l.properties,"LineString"===m.type&&(k=n.length-1,n[0][0]===n[k][0]&&n[0][1]===n[k][1]&&(n=m.coordinates)),"Polygon"===m.type&&(n=m.coordinates),"MultiPolygon"===m.type&&(n=m.coordinates[0]),n)){if(l.color||l.wallColor)j=l.color||l.wallColor;l.roofColor&&(q=l.roofColor);m=n[0];p=[];s=l.height;e=k=0;for(f=m.length;e<f;e++)p.push(m[e][1],m[e][0]),k+=s||m[e][2]||0;e={id:l.id||
p[0]+","+p[1],footprint:Ea(p)};k&&(e.height=k/m.length<<0);l.minHeight&&(e.minHeight=l.minHeight);j&&(e.wallColor=j);q&&(e.roofColor=q);h.push(e)}c=h}else a.osm3s&&(c=Ja(a.elements));b&&M.add(b,c);Z(c,!0)}},Z=function(a,b){var c,d,g,f,h,j,l=[],m,n,p,q,k,s,t,r,w,z=P-Q;g=0;for(f=a.length;g<f;g++)if(w=r=t=null,m=a[g],p=3*(m.height||15)>>z)if(q=3*m.minHeight>>z,!(q>V)){n=m.footprint;k=new Fa(n.length);h=0;for(j=n.length-1;h<j;h+=2)c=n[h+1],d=qa(1,xa(0,0.5-Pa(wa(Ya+Na*n[h]/180))/ia/2)),c=(c/360+0.5)*E<<
0,d=d*E<<0,k[h]=c,k[h+1]=d;h=k;j=h.length/2;n=new Ga(j);k=0;c=j-1;var x=d=void 0,u=void 0,v=void 0,D=[],F=[],H=[];for(n[k]=n[c]=1;c;){x=0;for(d=k+1;d<c;d++){var u=h[2*d],I=h[2*d+1],A=h[2*k],B=h[2*k+1],K=h[2*c],M=h[2*c+1],S=K-A,T=M-B,G=void 0;if(0!==S||0!==T)G=((u-A)*S+(I-B)*T)/(S*S+T*T),1<G?(A=K,B=M):0<G&&(A+=S*G,B+=T*G);S=u-A;T=I-B;u=S*S+T*T;u>x&&(v=d,x=u)}2<x&&(n[v]=1,D.push(k),F.push(v),D.push(v),F.push(c));k=D.pop();c=F.pop()}for(d=0;d<j;d++)n[d]&&H.push(h[2*d],h[2*d+1]);k=H;if(!(8>k.length)){if(m.wallColor&&
(s=U.parse(m.wallColor)))t=s.setAlpha(N),r=""+t.setLightness(0.8),t=""+t;if(m.roofColor&&(s=U.parse(m.roofColor)))w=""+s.setAlpha(N);l.push({id:m.id,footprint:k,height:qa(p,V),minHeight:q,wallColor:t,altColor:r,roofColor:w,center:J(k)})}}f=0;for(m=l.length;f<m;f++)g=l[f],sa[g.id]||(g.scale=b?0:1,pa.renderItems.push(l[f]),sa[g.id]=1);O||(O=setInterval(function(){for(var a,b=!1,c=0,y=C.renderItems.length;c<y;c++)a=C.renderItems[c],1>a.scale&&(a.scale+=0.1,1<a.scale&&(a.scale=1),b=!0);e();b||(clearInterval(O),
O=null)},33))},za,sa={},pa={renderItems:[],load:function(a){za=a||"http://overpass-api.de/api/interpreter?data=[out:json];(way[%22building%22]({s},{w},{n},{e});node(w);way[%22building:part%22=%22yes%22]({s},{w},{n},{e});node(w);relation[%22building%22]({s},{w},{n},{e});way(r);node(w););out;";pa.update()},update:function(){if(za&&!(15>Q)){var y=a(I,A),d=a(I+t,A+z),c=0.0075*(y.latitude/0.0075<<0)+0.0075,e=0.015*(d.longitude/0.015<<0)+0.015,d=0.0075*(d.latitude/0.0075<<0),y=0.015*(y.longitude/0.015<<
0);M.purge();pa.renderItems=[];sa={};for(var f,h,j;d<=c;d+=0.0075)for(f=y;f<=e;f+=0.015)j=d+","+f,(h=M.get(j))?Z(h):g(b(za,{n:(1E4*(d+0.0075)<<0)/1E4,e:(1E4*(f+0.015)<<0)/1E4,s:(1E4*d<<0)/1E4,w:(1E4*f<<0)/1E4}),ha(j))}},set:function(a){pa.renderItems=[];sa={};Y(a)}};C=pa;var ja,ua=function(a,b,c){return{x:a+ta.x*c,y:b+ta.y*c}},p,ca=!0,da=new U(0,0,0),ea=null,ta={x:0,y:0},Aa={setContext:function(a){p=a;Aa.setDate((new Date).setHours(10))},enable:function(a){ca=!!a},render:function(){var b,d,c,g;p.clearRect(0,
0,t,z);if(ca&&!(Q<F||ka))if(b=a(I+w,A+x),b=Ia(ea,b.latitude,b.longitude),!(0>=b.altitude)){d=1/wa(b.altitude);c=0.4/d;ta.x=Ra(b.azimuth)*d;ta.y=Qa(b.azimuth)*d;da.a=c;g=da+"";var f,e,h,j,l,m,n,r,q,k,s,u,v=[];p.beginPath();b=0;for(d=C.renderItems.length;b<d;b++){e=C.renderItems[b];r=!1;h=e.footprint;n=[];c=0;for(f=h.length-1;c<f;c+=2)n[c]=l=h[c]-I,n[c+1]=m=h[c+1]-A,r||(r=0<l&&l<t&&0<m&&m<z);if(r){h=1>e.scale?e.height*e.scale:e.height;e.minHeight&&(j=1>e.scale?e.minHeight*e.scale:e.minHeight);l=null;
c=0;for(f=n.length-3;c<f;c+=2)m=n[c],q=n[c+1],r=n[c+2],k=n[c+3],s=ua(m,q,h),u=ua(r,k,h),e.minHeight&&(q=ua(m,q,j),k=ua(r,k,j),m=q.x,q=q.y,r=k.x,k=k.y),(r-m)*(s.y-q)>(s.x-m)*(k-q)?(1===l&&p.lineTo(m,q),l=0,c||p.moveTo(m,q),p.lineTo(r,k)):(0===l&&p.lineTo(s.x,s.y),l=1,c||p.moveTo(s.x,s.y),p.lineTo(u.x,u.y));p.closePath();v.push(n)}}p.fillStyle=g;p.fill();p.globalCompositeOperation="destination-out";p.beginPath();b=0;for(d=v.length;b<d;b++){j=v[b];p.moveTo(j[0],j[1]);c=2;for(f=j.length;c<f;c+=2)p.lineTo(j[c],
j[c+1]);p.lineTo(j[0],j[1]);p.closePath()}p.fillStyle="#00ff00";p.fill();p.globalCompositeOperation="source-over"}},setDate:function(a){ea=a;Aa.render()}};ja=Aa;var ra,D,fa={MAX_HEIGHT:8,setContext:function(a){D=a},render:function(){D.clearRect(0,0,t,z);if(!(Q<F||ka)){var a,b,c,d,e,f,g,h,j;D.beginPath();a=0;for(b=C.renderItems.length;a<b;a++)if(c=C.renderItems[a],!(c.height>fa.MAX_HEIGHT)){j=!1;e=c.footprint;h=[];c=0;for(d=e.length-1;c<d;c+=2)h[c]=f=e[c]-I,h[c+1]=g=e[c+1]-A,j||(j=0<f&&f<t&&0<g&&g<
z);if(j){c=0;for(d=h.length-3;c<d;c+=2)j=h[c],e=h[c+1],c?D.lineTo(j,e):D.moveTo(j,e);D.closePath()}}D.fillStyle=oa;D.strokeStyle=na;D.stroke();D.fill()}}};ra=fa;var Ba,Ca=function(){var a=Ha.createElement("CANVAS");a.style.webkitTransform="translate3d(0,0,0)";a.style.imageRendering="optimizeSpeed";a.style.position="absolute";a.style.left=0;a.style.top=0;var b=a.getContext("2d");b.lineCap="round";b.lineJoin="round";b.lineWidth=1;b.mozImageSmoothingEnabled=!1;b.webkitImageSmoothingEnabled=!1;va.push(a);
G.appendChild(a);return b},G=Ha.createElement("DIV");G.style.pointerEvents="none";G.style.position="absolute";G.style.left=0;G.style.top=0;var va=[];ja.setContext(Ca());ra.setContext(Ca());v=Ca();Ba={appendTo:function(a){a.appendChild(G);return G},setSize:function(a,b){for(var c=0,d=va.length;c<d;c++)va[c].width=a,va[c].height=b}};var ga=this;if(window.DeviceMotionEvent){var Da=Math.abs;window.addEventListener("devicemotion",function(a){var b;if(a=a.accelerationIncludingGravity||a.acceleration)if(2<
Da(a.x)||2<Da(a.y)||2<Da(a.z)){switch(window.orientation){case -90:b=a.x;a.x=a.y;a.y=-b;break;case 90:b=a.x;a.x=-a.y;a.y=b;break;case 180:case -180:a.x*=-1,a.y*=-1}ga.setCamOffset(10*-a.x,10*-a.y);d()}})}window.addEventListener("mousemove",function(a){var b=Math.abs,c=t/2-a.x;a=z-a.y;if(2<b(c)||2<b(a))ga.setCamOffset(-c/3,-a/3),d()});this.setStyle=function(a){a=a||{};if(a.color||a.wallColor)B=U.parse(a.color||a.wallColor),H=B.setAlpha(N)+"",u=B.setLightness(0.8),na=u.setAlpha(N)+"",aa=B.setLightness(1.2),
oa=aa.setAlpha(N)+"";a.roofColor&&(aa=U.parse(a.roofColor),oa=aa.setAlpha(N)+"");void 0!==a.shadows&&ja.enable(a.shadows);e()};this.setCamOffset=function(a,b){la=w+a;ma=z+b};this.setMaxZoom=function(a){P=a};this.setDate=function(a){ja.setDate(a)};this.appendTo=function(a){return Ba.appendTo(a)};this.loadData=function(a){C.load(a)};this.setData=function(a){C.set(a)};this.onMoveEnd=function(){e();C.update()};this.onZoomEnd=function(a){ka=!1;r(a.zoom);C.update();e()};this.onZoomStart=function(){ka=!0;
e()};this.setOrigin=function(a,b){I=a;A=b};this.setSize=function(a,b){t=a;z=b;w=t/2<<0;x=z/2<<0;la=w;ma=z;$=t/(1.5/(window.devicePixelRatio||1))/wa(45)<<0;Ba.setSize(t,z);V=$-50};this.setZoom=r;this.render=d};h.VERSION="0.1.8a";h.ATTRIBUTION='&copy; <a href="http://osmbuildings.org">OSM Buildings</a>';return h}();
L.BuildingsLayer=L.Class.extend({map:null,osmb:null,container:null,blockMoveEvent:null,lastX:0,lastY:0,initialize:function(f){L.Util.setOptions(this,f)},onMove:function(){var f=L.DomUtil.getPosition(this.map._mapPane);this.osmb.setCamOffset(this.lastX-f.x,this.lastY-f.y);this.osmb.render()},onMoveEnd:function(){if(this.blockMoveEvent)this.blockMoveEvent=!1;else{var f=L.DomUtil.getPosition(this.map._mapPane),J=this.map.getPixelOrigin();this.lastX=f.x;this.lastY=f.y;this.container.style.left=-f.x+"px";
this.container.style.top=-f.y+"px";this.osmb.setCamOffset(0,0);this.osmb.setSize(this.map._size.x,this.map._size.y);this.osmb.setOrigin(J.x-f.x,J.y-f.y);this.osmb.onMoveEnd()}},onZoomStart:function(){this.osmb.onZoomStart()},onZoomEnd:function(){var f=L.DomUtil.getPosition(this.map._mapPane),J=this.map.getPixelOrigin();this.osmb.setOrigin(J.x-f.x,J.y-f.y);this.osmb.onZoomEnd({zoom:this.map._zoom});this.blockMoveEvent=!0},addTo:function(f){f.addLayer(this);return this},onAdd:function(f){this.map=f;
f=this.map._panes.overlayPane;this.osmb?f.appendChild(this.container):(this.osmb=new OSMBuildings,this.container=this.osmb.appendTo(f),this.osmb.maxZoom=this.map._layersMaxZoom);f=L.DomUtil.getPosition(this.map._mapPane);var J=this.map.getPixelOrigin();this.osmb.setSize(this.map._size.x,this.map._size.y);this.osmb.setOrigin(J.x-f.x,J.y-f.y);this.osmb.setZoom(this.map._zoom);this.container.style.left=-f.x+"px";this.container.style.top=-f.y+"px";this.map.on({move:this.onMove,moveend:this.onMoveEnd,
zoomstart:this.onZoomStart,zoomend:this.onZoomEnd},this);this.map.attributionControl.addAttribution(OSMBuildings.ATTRIBUTION);this.osmb.render()},onRemove:function(f){f.attributionControl.removeAttribution(OSMBuildings.ATTRIBUTION);f.off({move:this.onMove,moveend:this.onMoveEnd,zoomstart:this.onZoomStart,zoomend:this.onZoomEnd},this);this.container.parentNode.removeChild(this.container)},setStyle:function(f){this.osmb.setStyle(f);return this},setDate:function(f){this.osmb.setDate(f);return this},
load:function(f){this.osmb.loadData(f);return this},geoJSON:function(f){this.osmb.setData(f);return this}});
