var OSMBuildings=function(){function f(a,b){var g=a[0]-b[0],e=a[1]-b[1];return g*g+e*e}function M(a){for(var b=0,g=0,e=0,d=a.length-3;e<d;e+=2)b+=a[e],g+=a[e+1];a=(a.length-2)/2;return[b/a<<0,g/a<<0]}function Ea(a){var b,g,e,d,f=0,m,h;m=0;for(h=a.length-3;m<h;m+=2)b=a[m],g=a[m+1],e=a[m+2],d=a[m+3],f+=b*d-e*g;if("CW"===(0<f/2?"CW":"CCW"))return a;b=[];for(g=a.length-2;0<=g;g-=2)b.push(a[g],a[g+1]);return b}var Fa=Fa||Array,Ga=Ga||Array,h=Math,Na=h.exp,Oa=h.log,Pa=h.sin,Qa=h.cos,wa=h.tan,Ra=h.atan,
qa=h.min,xa=h.max,Ha=document,T,ba=function(a){var b,g,e;if(0===a.s)b=g=e=a.l;else{e=0.5>a.l?a.l*(1+a.s):a.l+a.s-a.l*a.s;var d=2*a.l-e;a.h/=360;b=U(d,e,a.h+1/3);g=U(d,e,a.h);e=U(d,e,a.h-1/3)}return new v(255*b<<0,255*g<<0,255*e<<0,a.a)},U=function(a,b,g){0>g&&(g+=1);1<g&&(g-=1);return g<1/6?a+6*(b-a)*g:0.5>g?b:g<2/3?a+6*(b-a)*(2/3-g):a},v=function(a,b,g,e){this.r=a;this.g=b;this.b=g;this.a=4>arguments.length?1:e},h=v.prototype;h.toString=function(){return"rgba("+[this.r<<0,this.g<<0,this.b<<0,this.a.toFixed(2)].join()+
")"};h.setLightness=function(a){var b=v.toHSLA(this);b.l*=a;b.l=Math.min(1,Math.max(0,b.l));return ba(b)};h.setAlpha=function(a){return new v(this.r,this.g,this.b,this.a*a)};v.parse=function(a){var b;a+="";if(~a.indexOf("#")&&(b=a.match(/^#?(\w{2})(\w{2})(\w{2})(\w{2})?$/)))return new v(parseInt(b[1],16),parseInt(b[2],16),parseInt(b[3],16),b[4]?parseInt(b[4],16)/255:1);if(b=a.match(/rgba?\((\d+)\D+(\d+)\D+(\d+)(\D+([\d.]+))?\)/))return new v(parseInt(b[1],10),parseInt(b[2],10),parseInt(b[3],10),b[4]?
parseFloat(b[5]):1);if(b=a.match(/hsla?\(([\d.]+)\D+([\d.]+)\D+([\d.]+)(\D+([\d.]+))?\)/))return ba({h:parseInt(b[1],10),s:parseFloat(b[2]),l:parseFloat(b[3]),a:b[4]?parseFloat(b[5]):1})};v.toHSLA=function(a){var b=a.r/255,g=a.g/255,e=a.b/255,d=Math.max(b,g,e),f=Math.min(b,g,e),m,h=(d+f)/2,t;if(d===f)m=f=0;else{t=d-f;f=0.5<h?t/(2-d-f):t/(d+f);switch(d){case b:m=(g-e)/t+(g<e?6:0);break;case g:m=(e-b)/t+2;break;case e:m=(b-g)/t+4}m/=6}return{h:360*m,s:f,l:h,a:a.a}};T=v;var Ia,h=Math,x=h.sin,F=h.cos,
Sa=h.tan,ca=h.asin,da=h.atan2,V=h.PI,j=180/V,Ta=357.5291/j,Ua=0.98560028/j,Va=1.9148/j,Wa=0.02/j,Xa=3E-4/j,Ya=102.9372/j,ea=23.45/j,Za=280.16/j,$a=360.9856235/j;Ia=function(a,b,g){g=-g/j;b/=j;a=a.valueOf()/864E5-0.5+2440588;var e=Ta+Ua*(a-2451545),d=Va*x(e)+Wa*x(2*e)+Xa*x(3*e),d=e+Ya+d+V,e=ca(x(d)*x(ea)),d=da(x(d)*F(ea),F(d));g=Za+$a*(a-2451545)-g-d;return{altitude:ca(x(b)*x(e)+F(b)*F(e)*F(g)),azimuth:da(x(g),F(g)*x(b)-Sa(e)*F(b))-V/2}};var Ja,P=function(a){var b=parseFloat(a);return~a.indexOf("m")?
b<<0:~a.indexOf("yd")?b*ab<<0:~a.indexOf("ft")?b*fa<<0:~a.indexOf("'")?(a=a.split("'"),a[0]*fa+a[1]*bb<<0):b<<0},u=function(a){a=a.toLowerCase();return"#"===a[0]?a:cb[a]||null},H=function(a){a=a.toLowerCase();return"#"===a[0]?a:db[eb[a]||a]||null},ga=function(a){return(a=a.tags)&&!a.landuse&&(a.building||a["building:part"])&&(!a.layer||0<=a.layer)},Ka=function(a){if(a){for(var b=[],g,e=0,d=a.length;e<d;e++)g=N[a[e]],b.push(g[0],g[1]);b[b.length-2]!==b[0]&&b[b.length-1]!==b[1]&&b.push(b[0],b[1]);if(!(8>
b.length))return b}},G=function(a){var b=0,g=0;a.height&&(b=P(a.height));!b&&a["building:height"]&&(b=P(a["building:height"]));!b&&a.levels&&(b=a.levels*I<<0);!b&&a["building:levels"]&&(b=a["building:levels"]*I<<0);a.min_height&&(g=P(a.min_height));!g&&a["building:min_height"]&&(g=P(a["building:min_height"]));!g&&a.min_level&&(g=a.min_level*I<<0);!g&&a["building:min_level"]&&(g=a["building:min_level"]*I<<0);var e,d;a["building:material"]&&(e=H(a["building:material"]));a["building:facade:material"]&&
(e=H(a["building:facade:material"]));a["building:cladding"]&&(e=H(a["building:cladding"]));a["building:color"]&&(e=u(a["building:color"]));a["building:colour"]&&(e=u(a["building:colour"]));a["roof:material"]&&(d=H(a["roof:material"]));a["building:roof:material"]&&(d=H(a["building:roof:material"]));a["roof:color"]&&(d=u(a["roof:color"]));a["roof:colour"]&&(d=u(a["roof:colour"]));a["building:roof:color"]&&(d=u(a["building:roof:color"]));a["building:roof:colour"]&&(d=u(a["building:roof:colour"]));return{height:b,
minHeight:g,wallColor:e,roofColor:d}},La=function(a,b,g){a={id:a,footprint:Ea(g)};b.height&&(a.height=b.height);b.minHeight&&(a.minHeight=b.minHeight);b.wallColor&&(a.wallColor=b.wallColor);b.roofColor&&(a.roofColor=b.roofColor);ha.push(a)},ab=0.9144,fa=0.3048,bb=0.0254,I=3,cb={black:"#000000",white:"#ffffff",brown:"#8b4513",green:"#00ff7f",grey:"#bebebe",gray:"#bebebe",lightgrey:"#d3d3d3",lightgray:"#d3d3d3",yellow:"#ffff00",red:"#ff0000",blue:"#0000ff"},eb={asphalt:"tar_paper",bitumen:"tar_paper",
block:"stone",bricks:"brick",glas:"glass",glassfront:"glass",grass:"plants",masonry:"stone",granite:"stone",panels:"panel",paving_stones:"stone",plastered:"plaster",rooftiles:"roof_tiles",roofingfelt:"tar_paper",sandstone:"stone",sheet:"canvas",sheets:"canvas",shingle:"tar_paper",shingles:"tar_paper",slates:"slate",steel:"metal",tar:"tar_paper",tent:"canvas",thatch:"plants",tile:"roof_tiles",tiles:"roof_tiles"},db={brick:"#cc7755",bronze:"#ffeecc",canvas:"#fff8f0",concrete:"#999999",copper:"#a0e0d0",
glass:"#e8f8f8",gold:"#ffcc00",plants:"#009933",metal:"#aaaaaa",panel:"#fff8f0",plaster:"#999999",roof_tiles:"#f08060",silver:"#cccccc",slate:"#666666",stone:"#996666",tar_paper:"#333333",wood:"#deb887"},N,Y,ha;Ja=function(a){N={};Y={};ha=[];for(var b,g=0,e=a.length;g<e;g++)switch(b=a[g],b.type){case "node":N[b.id]=[b.lat,b.lon];break;case "way":var d=void 0,f=void 0;ga(b)?(d=G(b.tags),(f=Ka(b.nodes))&&La(b.id,d,f)):(d=b.tags)&&(!d.highway&&!d.railway&&!d.landuse)&&(Y[b.id]=b);break;case "relation":var h=
d=d=void 0,f=void 0;if(ga(b)&&("multipolygon"===b.tags.type||"building"===b.tags.type)){a:{for(var d=b.members,f=void 0,h=0,j=d.length;h<j;h++)if(f=d[h],"way"===f.type&&"outer"===f.role){d=f;break a}d=void 0}if(d&&(b=G(b.tags),d=Y[d.ref]))if(h=G(d.tags),f=Ka(d.nodes)){j=void 0;for(j in b)h[j]||(h[j]=b[j]);La(d.id,h,f)}}}return ha};var ia=Math.PI,Ma=ia/2,fb=ia/4,gb=180/ia,hb=256,ib="latitude",jb="longitude",h=function(){function a(z,a){var c={};z/=F;a/=F;c[ib]=0>=a?90:1<=a?-90:gb*(2*Ra(Na(ia*(1-2*
a)))-Ma);c[jb]=360*(1===z?1:(z%1+1)%1)-180;return c}function b(a,b){return a.replace(/\{ *([\w_]+) *\}/g,function(a,z){return b[z]||a})}function g(a,b){var c=new XMLHttpRequest;c.onreadystatechange=function(){4===c.readyState&&c.status&&!(200>c.status||299<c.status)&&b&&c.responseText&&b(JSON.parse(c.responseText))};c.open("GET",a);c.send(null);return c}function e(){ja.render();ra.render();d()}function d(){w.clearRect(0,0,t,y);if(!(Q<I||ka)){var a,b,c,g,d,e,ya,C,l,n=ra.MAX_HEIGHT,p=[la+A,ma+B],J,
q,k,r,W,j;D.renderItems.sort(function(a,z){return f(z.center,p)/z.height-f(a.center,p)/a.height});a=0;for(b=D.renderItems.length;a<b;a++)if(d=D.renderItems[a],!(d.height<=n)){q=!1;e=d.footprint;J=[];c=0;for(g=e.length-1;c<g;c+=2)J[c]=C=e[c]-A,J[c+1]=l=e[c+1]-B,q||(q=0<C&&C<t&&0<l&&l<y);if(q){c=1>d.scale?d.height*d.scale:d.height;e=Z/(Z-c);d.minHeight&&(c=1>d.scale?d.minHeight*d.scale:d.minHeight,ya=Z/(Z-c));C=[];c=0;for(g=J.length-3;c<g;c+=2)l=J[c],k=J[c+1],q=J[c+2],r=J[c+3],W=m(l,k,e),j=m(q,r,e),
d.minHeight&&(k=m(l,k,ya),r=m(q,r,ya),l=k.x,k=k.y,q=r.x,r=r.y),(q-l)*(W.y-k)>(W.x-l)*(r-k)&&(w.fillStyle=l<q&&k<r||l>q&&k>r?d.altColor||na:d.wallColor||H,h([q,r,l,k,W.x,W.y,j.x,j.y])),C[c]=W.x,C[c+1]=W.y;w.fillStyle=d.roofColor||oa;w.strokeStyle=d.altColor||na;h(C,!0)}}}}function h(a,b){if(a.length){w.beginPath();w.moveTo(a[0],a[1]);for(var c=2,d=a.length;c<d;c+=2)w.lineTo(a[c],a[c+1]);w.closePath();b&&w.stroke();w.fill()}}function m(a,b,c){return{x:(a-la)*c+la<<0,y:(b-ma)*c+ma<<0}}function j(a){Q=
a;F=hb<<Q;a=Q;var b=I,c=U;a=qa(xa(a,b),c);O=1-qa(xa(0+0.3*((a-b)/(c-b)),0),0.3);H=K.setAlpha(O)+"";na=u.setAlpha(O)+"";oa=$.setAlpha(O)+""}var t=0,y=0,x=0,v=0,A=0,B=0,Q,F,w,K=new T(200,190,180),u=K.setLightness(0.8),$=K.setLightness(1.2),H=K+"",na=u+"",oa=$+"",P,O=1,I=15,U=20,V,la,ma,Z,ka,N=new Date,aa={},G={add:function(a,b){aa[a]={data:b,time:Date.now()}},get:function(a){return aa[a]&&aa[a].data},purge:function(){N.setMinutes(N.getMinutes()-5);for(var a in aa)aa[a].time<N&&delete aa[a]}},D,ha=function(a){return function(b){Y(b,
a)}},Y=function(a,b){if(a){var c;if("FeatureCollection"===a.type){c=a.features;var d,g,e,f,h=[],l,n,p,J,q,k,r,j;d=0;for(g=c.length;d<g;d++)if(l=c[d],"Feature"===l.type&&(n=l.geometry,l=l.properties,"LineString"===n.type&&(k=p.length-1,p[0][0]===p[k][0]&&p[0][1]===p[k][1]&&(p=n.coordinates)),"Polygon"===n.type&&(p=n.coordinates),"MultiPolygon"===n.type&&(p=n.coordinates[0]),p)){if(l.color||l.wallColor)J=l.color||l.wallColor;l.roofColor&&(q=l.roofColor);n=p[0];j=[];r=l.height;e=k=0;for(f=n.length;e<
f;e++)j.push(n[e][1],n[e][0]),k+=r||n[e][2]||0;e={id:l.id||j[0]+","+j[1],footprint:Ea(j)};k&&(e.height=k/n.length<<0);l.minHeight&&(e.minHeight=l.minHeight);J&&(e.wallColor=J);q&&(e.roofColor=q);h.push(e)}c=h}else a.osm3s&&(c=Ja(a.elements));b&&G.add(b,c);ba(c,!0)}},ba=function(a,b){var c,d,g,f,h,C,l=[],n,p,j,q,k,r,m,s,t,x=U-Q;g=0;for(f=a.length;g<f;g++)if(t=s=m=null,n=a[g],j=3*(n.height||15)>>x)if(q=3*n.minHeight>>x,!(q>V)){p=n.footprint;k=new Fa(p.length);h=0;for(C=p.length-1;h<C;h+=2)c=p[h+1],
d=qa(1,xa(0,0.5-Oa(wa(fb+Ma*p[h]/180))/ia/2)),c=(c/360+0.5)*F<<0,d=d*F<<0,k[h]=c,k[h+1]=d;h=k;C=h.length/2;p=new Ga(C);k=0;c=C-1;var y=d=void 0,v=void 0,u=void 0,w=[],E=[],H=[];for(p[k]=p[c]=1;c;){y=0;for(d=k+1;d<c;d++){var v=h[2*d],I=h[2*d+1],A=h[2*k],B=h[2*k+1],K=h[2*c],N=h[2*c+1],R=K-A,S=N-B,G=void 0;if(0!==R||0!==S)G=((v-A)*R+(I-B)*S)/(R*R+S*S),1<G?(A=K,B=N):0<G&&(A+=R*G,B+=S*G);R=v-A;S=I-B;v=R*R+S*S;v>y&&(u=d,y=v)}2<y&&(p[u]=1,w.push(k),E.push(u),w.push(u),E.push(c));k=w.pop();c=E.pop()}for(d=
0;d<C;d++)p[d]&&H.push(h[2*d],h[2*d+1]);k=H;if(!(8>k.length)){if(n.wallColor&&(r=T.parse(n.wallColor)))m=r.setAlpha(O),s=""+m.setLightness(0.8),m=""+m;if(n.roofColor&&(r=T.parse(n.roofColor)))t=""+r.setAlpha(O);l.push({id:n.id,footprint:k,height:qa(j,V),minHeight:q,wallColor:m,altColor:s,roofColor:t,center:M(k)})}}f=0;for(n=l.length;f<n;f++)g=l[f],sa[g.id]||(g.scale=b?0:1,pa.renderItems.push(l[f]),sa[g.id]=1);P||(P=setInterval(function(){for(var a,b=!1,c=0,z=D.renderItems.length;c<z;c++)a=D.renderItems[c],
1>a.scale&&(a.scale+=0.1,1<a.scale&&(a.scale=1),b=!0);e();b||(clearInterval(P),P=null)},33))},za,sa={},pa={renderItems:[],load:function(a){za=a;pa.update()},update:function(){if(za&&!(15>Q)){var z=a(A,B),d=a(A+t,B+y),c=0.0075*(z.latitude/0.0075<<0)+0.0075,e=0.015*(d.longitude/0.015<<0)+0.015,d=0.0075*(d.latitude/0.0075<<0),z=0.015*(z.longitude/0.015<<0);G.purge();pa.renderItems=[];sa={};for(var f,h,j;d<=c;d+=0.0075)for(f=z;f<=e;f+=0.015)j=d+","+f,(h=G.get(j))?ba(h):g(b(za,{n:(1E4*(d+0.0075)<<0)/1E4,
e:(1E4*(f+0.015)<<0)/1E4,s:(1E4*d<<0)/1E4,w:(1E4*f<<0)/1E4}),ha(j))}},set:function(a){pa.renderItems=[];sa={};Y(a)}};D=pa;var ja,ua=function(a,b,c){return{x:a+ta.x*c,y:b+ta.y*c}},s,ca=!0,da=new T(0,0,0),ea=null,ta={x:0,y:0},Aa={setContext:function(a){s=a;Aa.setDate((new Date).setHours(10))},enable:function(a){ca=!!a},render:function(){var b,d,c,g;s.clearRect(0,0,t,y);if(ca&&!(Q<I||ka))if(b=a(A+x,B+v),b=Ia(ea,b.latitude,b.longitude),!(0>=b.altitude)){d=1/wa(b.altitude);c=0.4/d;ta.x=Qa(b.azimuth)*d;
ta.y=Pa(b.azimuth)*d;da.a=c;g=da+"";var f,e,h,j,l,n,p,m,q,k,r,u,w=[];s.beginPath();b=0;for(d=D.renderItems.length;b<d;b++){e=D.renderItems[b];m=!1;h=e.footprint;p=[];c=0;for(f=h.length-1;c<f;c+=2)p[c]=l=h[c]-A,p[c+1]=n=h[c+1]-B,m||(m=0<l&&l<t&&0<n&&n<y);if(m){h=1>e.scale?e.height*e.scale:e.height;e.minHeight&&(j=1>e.scale?e.minHeight*e.scale:e.minHeight);l=null;c=0;for(f=p.length-3;c<f;c+=2)n=p[c],q=p[c+1],m=p[c+2],k=p[c+3],r=ua(n,q,h),u=ua(m,k,h),e.minHeight&&(q=ua(n,q,j),k=ua(m,k,j),n=q.x,q=q.y,
m=k.x,k=k.y),(m-n)*(r.y-q)>(r.x-n)*(k-q)?(1===l&&s.lineTo(n,q),l=0,c||s.moveTo(n,q),s.lineTo(m,k)):(0===l&&s.lineTo(r.x,r.y),l=1,c||s.moveTo(r.x,r.y),s.lineTo(u.x,u.y));s.closePath();w.push(p)}}s.fillStyle=g;s.fill();s.globalCompositeOperation="destination-out";s.beginPath();b=0;for(d=w.length;b<d;b++){j=w[b];s.moveTo(j[0],j[1]);c=2;for(f=j.length;c<f;c+=2)s.lineTo(j[c],j[c+1]);s.lineTo(j[0],j[1]);s.closePath()}s.fillStyle="#00ff00";s.fill();s.globalCompositeOperation="source-over"}},setDate:function(a){ea=
a;Aa.render()}};ja=Aa;var ra,E,fa={MAX_HEIGHT:8,setContext:function(a){E=a},render:function(){E.clearRect(0,0,t,y);if(!(Q<I||ka)){var a,b,c,d,e,f,g,h,j;E.beginPath();a=0;for(b=D.renderItems.length;a<b;a++)if(c=D.renderItems[a],!(c.height>fa.MAX_HEIGHT)){j=!1;e=c.footprint;h=[];c=0;for(d=e.length-1;c<d;c+=2)h[c]=f=e[c]-A,h[c+1]=g=e[c+1]-B,j||(j=0<f&&f<t&&0<g&&g<y);if(j){c=0;for(d=h.length-3;c<d;c+=2)j=h[c],e=h[c+1],c?E.lineTo(j,e):E.moveTo(j,e);E.closePath()}}E.fillStyle=oa;E.strokeStyle=na;E.stroke();
E.fill()}}};ra=fa;var Ba,Ca=function(){var a=Ha.createElement("CANVAS");a.style.webkitTransform="translate3d(0,0,0)";a.style.imageRendering="optimizeSpeed";a.style.position="absolute";a.style.left=0;a.style.top=0;var b=a.getContext("2d");b.lineCap="round";b.lineJoin="round";b.lineWidth=1;b.mozImageSmoothingEnabled=!1;b.webkitImageSmoothingEnabled=!1;va.push(a);X.appendChild(a);return b},X=Ha.createElement("DIV");X.style.pointerEvents="none";X.style.position="absolute";X.style.left=0;X.style.top=0;
var va=[];ja.setContext(Ca());ra.setContext(Ca());w=Ca();Ba={appendTo:function(a){a.appendChild(X);return X},setSize:function(a,b){for(var c=0,d=va.length;c<d;c++)va[c].width=a,va[c].height=b}};var ga=this;if(window.DeviceMotionEvent){var Da=Math.abs;window.addEventListener("devicemotion",function(a){var b;if(a=a.accelerationIncludingGravity||a.acceleration)if(2<Da(a.x)||2<Da(a.y)||2<Da(a.z)){switch(window.orientation){case -90:b=a.x;a.x=a.y;a.y=-b;break;case 90:b=a.x;a.x=-a.y;a.y=b;break;case 180:case -180:a.x*=
-1,a.y*=-1}ga.setCamOffset(10*-a.x,10*-a.y);d()}})}window.addEventListener("mousemove",function(a){var b=Math.abs,c=t/2-a.x;a=y-a.y;if(2<b(c)||2<b(a))ga.setCamOffset(-c/3,-a/3),d()});this.setStyle=function(a){a=a||{};if(a.color||a.wallColor)K=T.parse(a.color||a.wallColor),H=K.setAlpha(O)+"",u=K.setLightness(0.8),na=u.setAlpha(O)+"",$=K.setLightness(1.2),oa=$.setAlpha(O)+"";a.roofColor&&($=T.parse(a.roofColor),oa=$.setAlpha(O)+"");void 0!==a.shadows&&ja.enable(a.shadows);e();return this};this.setCamOffset=
function(a,b){la=x+a;ma=y+b};this.setMaxZoom=function(a){U=a};this.setDate=function(a){ja.setDate(a);return this};this.appendTo=function(a){return Ba.appendTo(a)};this.loadData=function(a){D.load(a);return this};this.setData=function(a){D.set(a);return this};this.onMoveEnd=function(){e();D.update()};this.onZoomEnd=function(a){ka=!1;j(a.zoom);D.update();e()};this.onZoomStart=function(){ka=!0;e()};this.setOrigin=function(a,b){A=a;B=b};this.setSize=function(a,b){t=a;y=b;x=t/2<<0;v=y/2<<0;la=x;ma=y;Z=
t/(1.5/(window.devicePixelRatio||1))/wa(45)<<0;Ba.setSize(t,y);V=Z-50};this.setZoom=j;this.render=d};h.VERSION="0.1.8a";h.ATTRIBUTION='&copy; <a href="http://osmbuildings.org">OSM Buildings</a>';h.OSM_XAPI_URL="http://overpass-api.de/api/interpreter?data=[out:json];(way[%22building%22]({s},{w},{n},{e});node(w);way[%22building:part%22=%22yes%22]({s},{w},{n},{e});node(w);relation[%22building%22]({s},{w},{n},{e});way(r);node(w););out;";return h}();
L.BuildingsLayer=L.Class.extend({map:null,osmb:null,container:null,blockMoveEvent:null,lastX:0,lastY:0,initialize:function(f){L.Util.setOptions(this,f)},onMove:function(){var f=L.DomUtil.getPosition(this.map._mapPane);this.osmb.setCamOffset(this.lastX-f.x,this.lastY-f.y);this.osmb.render()},onMoveEnd:function(){if(this.blockMoveEvent)this.blockMoveEvent=!1;else{var f=L.DomUtil.getPosition(this.map._mapPane),M=this.map.getPixelOrigin();this.lastX=f.x;this.lastY=f.y;this.container.style.left=-f.x+"px";
this.container.style.top=-f.y+"px";this.osmb.setCamOffset(0,0);this.osmb.setSize(this.map._size.x,this.map._size.y);this.osmb.setOrigin(M.x-f.x,M.y-f.y);this.osmb.onMoveEnd()}},onZoomStart:function(){this.osmb.onZoomStart()},onZoomEnd:function(){var f=L.DomUtil.getPosition(this.map._mapPane),M=this.map.getPixelOrigin();this.osmb.setOrigin(M.x-f.x,M.y-f.y);this.osmb.onZoomEnd({zoom:this.map._zoom});this.blockMoveEvent=!0},addTo:function(f){f.addLayer(this);return this},onAdd:function(f){this.map=f;
f=this.map._panes.overlayPane;this.osmb?f.appendChild(this.container):(this.osmb=new OSMBuildings,this.container=this.osmb.appendTo(f),this.osmb.maxZoom=this.map._layersMaxZoom);f=L.DomUtil.getPosition(this.map._mapPane);var M=this.map.getPixelOrigin();this.osmb.setSize(this.map._size.x,this.map._size.y);this.osmb.setOrigin(M.x-f.x,M.y-f.y);this.osmb.setZoom(this.map._zoom);this.container.style.left=-f.x+"px";this.container.style.top=-f.y+"px";this.map.on({move:this.onMove,moveend:this.onMoveEnd,
zoomstart:this.onZoomStart,zoomend:this.onZoomEnd},this);this.map.attributionControl.addAttribution(OSMBuildings.ATTRIBUTION);this.osmb.render()},onRemove:function(f){f.attributionControl.removeAttribution(OSMBuildings.ATTRIBUTION);f.off({move:this.onMove,moveend:this.onMoveEnd,zoomstart:this.onZoomStart,zoomend:this.onZoomEnd},this);this.container.parentNode.removeChild(this.container)},setStyle:function(f){this.osmb.setStyle(f);return this},setDate:function(f){this.osmb.setDate(f);return this},
load:function(f){this.osmb.loadData(f);return this},geoJSON:function(f){this.osmb.setData(f);return this}});
