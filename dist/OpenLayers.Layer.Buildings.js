var OSMBuildings=function(){function f(a,b){var e=a[0]-b[0],g=a[1]-b[1];return e*e+g*g}function K(a){for(var b=0,e=0,g=0,d=a.length-3;g<d;g+=2)b+=a[g],e+=a[g+1];a=(a.length-2)/2;return[b/a<<0,e/a<<0]}function u(a){var b,e,g,d,f=0,j,h;j=0;for(h=a.length-3;j<h;j+=2)b=a[j],e=a[j+1],g=a[j+2],d=a[j+3],f+=b*d-g*e;if("CW"===(0<f/2?"CW":"CCW"))return a;b=[];for(e=a.length-2;0<=e;e-=2)b.push(a[e],a[e+1]);return b}var Y=Y||Array,Fa=Fa||Array,h=Math,Na=h.exp,Oa=h.log,Pa=h.sin,Qa=h.cos,xa=h.tan,Ra=h.atan,ra=
h.min,ya=h.max,Ga=document,T,da=function(a){var b,e,g;if(0===a.s)b=e=g=a.l;else{g=0.5>a.l?a.l*(1+a.s):a.l+a.s-a.l*a.s;var d=2*a.l-g;a.h/=360;b=U(d,g,a.h+1/3);e=U(d,g,a.h);g=U(d,g,a.h-1/3)}return new x(255*b<<0,255*e<<0,255*g<<0,a.a)},U=function(a,b,e){0>e&&(e+=1);1<e&&(e-=1);return e<1/6?a+6*(b-a)*e:0.5>e?b:e<2/3?a+6*(b-a)*(2/3-e):a},x=function(a,b,e,g){this.r=a;this.g=b;this.b=e;this.a=4>arguments.length?1:g},h=x.prototype;h.toString=function(){return"rgba("+[this.r<<0,this.g<<0,this.b<<0,this.a.toFixed(2)].join()+
")"};h.setLightness=function(a){var b=x.toHSLA(this);b.l*=a;b.l=Math.min(1,Math.max(0,b.l));return da(b)};h.setAlpha=function(a){return new x(this.r,this.g,this.b,this.a*a)};x.parse=function(a){var b;a+="";if(~a.indexOf("#")&&(b=a.match(/^#?(\w{2})(\w{2})(\w{2})(\w{2})?$/)))return new x(parseInt(b[1],16),parseInt(b[2],16),parseInt(b[3],16),b[4]?parseInt(b[4],16)/255:1);if(b=a.match(/rgba?\((\d+)\D+(\d+)\D+(\d+)(\D+([\d.]+))?\)/))return new x(parseInt(b[1],10),parseInt(b[2],10),parseInt(b[3],10),b[4]?
parseFloat(b[5]):1);if(b=a.match(/hsla?\(([\d.]+)\D+([\d.]+)\D+([\d.]+)(\D+([\d.]+))?\)/))return da({h:parseInt(b[1],10),s:parseFloat(b[2]),l:parseFloat(b[3]),a:b[4]?parseFloat(b[5]):1})};x.toHSLA=function(a){var b=a.r/255,e=a.g/255,g=a.b/255,d=Math.max(b,e,g),f=Math.min(b,e,g),j,h=(d+f)/2,t;if(d===f)j=f=0;else{t=d-f;f=0.5<h?t/(2-d-f):t/(d+f);switch(d){case b:j=(e-g)/t+(e<g?6:0);break;case e:j=(g-b)/t+2;break;case g:j=(b-e)/t+4}j/=6}return{h:360*j,s:f,l:h,a:a.a}};T=x;var Ha,h=Math,L=h.PI,r=h.sin,
w=h.cos,ea=h.tan,fa=h.asin,ga=h.atan2,F=L/180,N=23.4397*F;Ha=function(a,b,e){e=F*-e;b*=F;a=a.valueOf()/864E5-0.5+2440588-2451545;var g=F*(357.5291+0.98560028*a),d=F*(1.9148*r(g)+0.02*r(2*g)+3E-4*r(3*g)),d=g+d+102.9372*F+L,g=fa(r(0)*w(N)+w(0)*r(N)*r(d)),d=ga(r(d)*w(N)-ea(0)*r(N),w(d));e=F*(280.16+360.9856235*a)-e-d;return{altitude:fa(r(b)*r(g)+w(b)*w(g)*w(e)),azimuth:ga(r(e),w(e)*r(b)-ea(g)*w(b))-L/2}};var Ia,H=function(a){var b=parseFloat(a);return~a.indexOf("m")?b<<0:~a.indexOf("yd")?b*Sa<<0:~a.indexOf("ft")?
b*ha<<0:~a.indexOf("'")?(a=a.split("'"),a[0]*ha+a[1]*Ta<<0):b<<0},v=function(a){a=a.toLowerCase();return"#"===a[0]?a:Ua[a]||null},I=function(a){a=a.toLowerCase();return"#"===a[0]?a:Va[Wa[a]||a]||null},Ja=function(a){return(a=a.tags)&&!a.landuse&&(a.building||a["building:part"])&&(!a.layer||0<=a.layer)},Ka=function(a){if(a){for(var b=[],e,g=0,d=a.length;g<d;g++)e=G[a[g]],b.push(e[0],e[1]);b[b.length-2]!==b[0]&&b[b.length-1]!==b[1]&&b.push(b[0],b[1]);if(!(8>b.length))return b}},ia=function(a){var b=
0,e=0;a.height&&(b=H(a.height));!b&&a["building:height"]&&(b=H(a["building:height"]));!b&&a.levels&&(b=a.levels*O<<0);!b&&a["building:levels"]&&(b=a["building:levels"]*O<<0);a.min_height&&(e=H(a.min_height));!e&&a["building:min_height"]&&(e=H(a["building:min_height"]));!e&&a.min_level&&(e=a.min_level*O<<0);!e&&a["building:min_level"]&&(e=a["building:min_level"]*O<<0);var g,d;a["building:material"]&&(g=I(a["building:material"]));a["building:facade:material"]&&(g=I(a["building:facade:material"]));a["building:cladding"]&&
(g=I(a["building:cladding"]));a["building:color"]&&(g=v(a["building:color"]));a["building:colour"]&&(g=v(a["building:colour"]));a["roof:material"]&&(d=I(a["roof:material"]));a["building:roof:material"]&&(d=I(a["building:roof:material"]));a["roof:color"]&&(d=v(a["roof:color"]));a["roof:colour"]&&(d=v(a["roof:colour"]));a["building:roof:color"]&&(d=v(a["building:roof:color"]));a["building:roof:colour"]&&(d=v(a["building:roof:colour"]));return{height:b,minHeight:e,wallColor:g,roofColor:d}},La=function(a,
b,e){a={id:a,footprint:u(e)};b.height&&(a.height=b.height);b.minHeight&&(a.minHeight=b.minHeight);b.wallColor&&(a.wallColor=b.wallColor);b.roofColor&&(a.roofColor=b.roofColor);Z.push(a)},Sa=0.9144,ha=0.3048,Ta=0.0254,O=3,Ua={black:"#000000",white:"#ffffff",brown:"#8b4513",green:"#00ff7f",grey:"#bebebe",gray:"#bebebe",lightgrey:"#d3d3d3",lightgray:"#d3d3d3",yellow:"#ffff00",red:"#ff0000",blue:"#0000ff"},Wa={asphalt:"tar_paper",bitumen:"tar_paper",block:"stone",bricks:"brick",glas:"glass",glassfront:"glass",
grass:"plants",masonry:"stone",granite:"stone",panels:"panel",paving_stones:"stone",plastered:"plaster",rooftiles:"roof_tiles",roofingfelt:"tar_paper",sandstone:"stone",sheet:"canvas",sheets:"canvas",shingle:"tar_paper",shingles:"tar_paper",slates:"slate",steel:"metal",tar:"tar_paper",tent:"canvas",thatch:"plants",tile:"roof_tiles",tiles:"roof_tiles"},Va={brick:"#cc7755",bronze:"#ffeecc",canvas:"#fff8f0",concrete:"#999999",copper:"#a0e0d0",glass:"#e8f8f8",gold:"#ffcc00",plants:"#009933",metal:"#aaaaaa",
panel:"#fff8f0",plaster:"#999999",roof_tiles:"#f08060",silver:"#cccccc",slate:"#666666",stone:"#996666",tar_paper:"#333333",wood:"#deb887"},G,$,Z;Ia=function(a){G={};$={};Z=[];for(var b,e=0,g=a.length;e<g;e++)switch(b=a[e],b.type){case "node":G[b.id]=[b.lat,b.lon];break;case "way":var d=void 0,f=void 0;Ja(b)?(d=ia(b.tags),(f=Ka(b.nodes))&&La(b.id,d,f)):(d=b.tags)&&(!d.highway&&!d.railway&&!d.landuse)&&($[b.id]=b);break;case "relation":var j=d=d=void 0,f=void 0;if(Ja(b)&&("multipolygon"===b.tags.type||
"building"===b.tags.type)){a:{for(var d=b.members,f=void 0,j=0,h=d.length;j<h;j++)if(f=d[j],"way"===f.type&&"outer"===f.role){d=f;break a}d=void 0}if(d&&(b=ia(b.tags),d=$[d.ref]))if(j=ia(d.tags),f=Ka(d.nodes)){h=void 0;for(h in b)j[h]||(j[h]=b[h]);La(d.id,j,f)}}}return Z};var ja=Math.PI,Ma=ja/2,Xa=ja/4,Ya=180/ja,Za=256,$a="latitude",ab="longitude",h=function(){function a(y,a){var c={};y/=F;a/=F;c[$a]=0>=a?90:1<=a?-90:Ya*(2*Ra(Na(ja*(1-2*a)))-Ma);c[ab]=360*(1===y?1:(y%1+1)%1)-180;return c}function b(a,
b){return a.replace(/\{ *([\w_]+) *\}/g,function(a,y){return b[y]||a})}function e(a,b){var c=new XMLHttpRequest;c.onreadystatechange=function(){4===c.readyState&&c.status&&!(200>c.status||299<c.status)&&b&&c.responseText&&b(JSON.parse(c.responseText))};c.open("GET",a);c.send(null);return c}function g(){ka.render();sa.render();d()}function d(){A.clearRect(0,0,t,z);if(!(P<H||la)){var a,b,c,e,d,g,za,V,l,m=sa.MAX_HEIGHT,n=[ma+B,na+C],Q,q,k,s,W,p;D.renderItems.sort(function(a,y){return f(y.center,n)/y.height-
f(a.center,n)/a.height});a=0;for(b=D.renderItems.length;a<b;a++)if(d=D.renderItems[a],!(d.height<=m)){q=!1;g=d.footprint;Q=[];c=0;for(e=g.length-1;c<e;c+=2)Q[c]=V=g[c]-B,Q[c+1]=l=g[c+1]-C,q||(q=0<V&&V<t&&0<l&&l<z);if(q){c=1>d.scale?d.height*d.scale:d.height;g=aa/(aa-c);d.minHeight&&(c=1>d.scale?d.minHeight*d.scale:d.minHeight,za=aa/(aa-c));V=[];c=0;for(e=Q.length-3;c<e;c+=2)l=Q[c],k=Q[c+1],q=Q[c+2],s=Q[c+3],W=j(l,k,g),p=j(q,s,g),d.minHeight&&(k=j(l,k,za),s=j(q,s,za),l=k.x,k=k.y,q=s.x,s=s.y),(q-l)*
(W.y-k)>(W.x-l)*(s-k)&&(A.fillStyle=l<q&&k<s||l>q&&k>s?d.altColor||oa:d.wallColor||I,h([q,s,l,k,W.x,W.y,p.x,p.y])),V[c]=W.x,V[c+1]=W.y;A.fillStyle=d.roofColor||pa;A.strokeStyle=d.altColor||oa;h(V,!0)}}}}function h(a,b){if(a.length){A.beginPath();A.moveTo(a[0],a[1]);for(var c=2,d=a.length;c<d;c+=2)A.lineTo(a[c],a[c+1]);A.closePath();b&&A.stroke();A.fill()}}function j(a,b,c){return{x:(a-ma)*c+ma<<0,y:(b-na)*c+na<<0}}function r(a){P=a;F=Za<<P;a=P;var b=H,c=O;a=ra(ya(a,b),c);M=1-ra(ya(0+0.3*((a-b)/(c-
b)),0),0.3);I=J.setAlpha(M)+"";oa=v.setAlpha(M)+"";pa=ba.setAlpha(M)+""}var t=0,z=0,x=0,w=0,B=0,C=0,P,F,A,J=new T(200,190,180),v=J.setLightness(0.8),ba=J.setLightness(1.2),I=J+"",oa=v+"",pa=ba+"",N,M=1,H=15,O=20,U,ma,na,aa,la,L=new Date,ca={},G={add:function(a,b){ca[a]={data:b,time:Date.now()}},get:function(a){return ca[a]&&ca[a].data},purge:function(){L.setMinutes(L.getMinutes()-5);for(var a in ca)ca[a].time<L&&delete ca[a]}},D,ia=function(a){return function(b){Z(b,a)}},Z=function(a,b){if(a){var c;
if("FeatureCollection"===a.type){c=a.features;var d,e,g,f,h=[],l,m,n,j,q,k,s,p;d=0;for(e=c.length;d<e;d++)if(l=c[d],"Feature"===l.type&&(m=l.geometry,l=l.properties,"LineString"===m.type&&(k=n.length-1,n[0][0]===n[k][0]&&n[0][1]===n[k][1]&&(n=m.coordinates)),"Polygon"===m.type&&(n=m.coordinates),"MultiPolygon"===m.type&&(n=m.coordinates[0]),n)){if(l.color||l.wallColor)j=l.color||l.wallColor;l.roofColor&&(q=l.roofColor);m=n[0];p=[];s=l.height;g=k=0;for(f=m.length;g<f;g++)p.push(m[g][1],m[g][0]),k+=
s||m[g][2]||0;g={id:l.id||p[0]+","+p[1],footprint:u(p)};k&&(g.height=k/m.length<<0);l.minHeight&&(g.minHeight=l.minHeight);j&&(g.wallColor=j);q&&(g.roofColor=q);h.push(g)}c=h}else a.osm3s&&(c=Ia(a.elements));b&&G.add(b,c);$(c,!0)}},$=function(a,b){var c,d,e,f,h,j,l=[],m,n,p,q,k,s,t,r,x,z=O-P;e=0;for(f=a.length;e<f;e++)if(x=r=t=null,m=a[e],p=3*(m.height||15)>>z)if(q=3*m.minHeight>>z,!(q>U)){n=m.footprint;k=new Y(n.length);h=0;for(j=n.length-1;h<j;h+=2)c=n[h+1],d=ra(1,ya(0,0.5-Oa(xa(Xa+Ma*n[h]/180))/
ja/2)),c=(c/360+0.5)*F<<0,d=d*F<<0,k[h]=c,k[h+1]=d;h=k;j=h.length/2;n=new Fa(j);k=0;c=j-1;var u=d=void 0,w=void 0,v=void 0,A=[],E=[],H=[];for(n[k]=n[c]=1;c;){u=0;for(d=k+1;d<c;d++){var w=h[2*d],I=h[2*d+1],B=h[2*k],C=h[2*k+1],J=h[2*c],L=h[2*c+1],R=J-B,S=L-C,G=void 0;if(0!==R||0!==S)G=((w-B)*R+(I-C)*S)/(R*R+S*S),1<G?(B=J,C=L):0<G&&(B+=R*G,C+=S*G);R=w-B;S=I-C;w=R*R+S*S;w>u&&(v=d,u=w)}2<u&&(n[v]=1,A.push(k),E.push(v),A.push(v),E.push(c));k=A.pop();c=E.pop()}for(d=0;d<j;d++)n[d]&&H.push(h[2*d],h[2*d+1]);
k=H;if(!(8>k.length)){if(m.wallColor&&(s=T.parse(m.wallColor)))t=s.setAlpha(M),r=""+t.setLightness(0.8),t=""+t;if(m.roofColor&&(s=T.parse(m.roofColor)))x=""+s.setAlpha(M);l.push({id:m.id,footprint:k,height:ra(p,U),minHeight:q,wallColor:t,altColor:r,roofColor:x,center:K(k)})}}f=0;for(m=l.length;f<m;f++)e=l[f],ta[e.id]||(e.scale=b?0:1,qa.renderItems.push(l[f]),ta[e.id]=1);N||(N=setInterval(function(){for(var a,b=!1,c=0,y=D.renderItems.length;c<y;c++)a=D.renderItems[c],1>a.scale&&(a.scale+=0.1,1<a.scale&&
(a.scale=1),b=!0);g();b||(clearInterval(N),N=null)},33))},Aa,ta={},qa={renderItems:[],load:function(a){Aa=a||"http://overpass-api.de/api/interpreter?data=[out:json];(way[%22building%22]({s},{w},{n},{e});node(w);way[%22building:part%22=%22yes%22]({s},{w},{n},{e});node(w);relation[%22building%22]({s},{w},{n},{e});way(r);node(w););out;";qa.update()},update:function(){if(Aa&&!(15>P)){var y=a(B,C),d=a(B+t,C+z),c=0.0075*(y.latitude/0.0075<<0)+0.0075,g=0.015*(d.longitude/0.015<<0)+0.015,d=0.0075*(d.latitude/
0.0075<<0),y=0.015*(y.longitude/0.015<<0);G.purge();qa.renderItems=[];ta={};for(var f,h,j;d<=c;d+=0.0075)for(f=y;f<=g;f+=0.015)j=d+","+f,(h=G.get(j))?$(h):e(b(Aa,{n:(1E4*(d+0.0075)<<0)/1E4,e:(1E4*(f+0.015)<<0)/1E4,s:(1E4*d<<0)/1E4,w:(1E4*f<<0)/1E4}),ia(j))}},set:function(a){qa.renderItems=[];ta={};Z(a)}};D=qa;var ka,va=function(a,b,c){return{x:a+ua.x*c,y:b+ua.y*c}},p,da=!0,ea=new T(0,0,0),fa=null,ua={x:0,y:0},Ba={setContext:function(a){p=a;Ba.setDate((new Date).setHours(10))},enable:function(a){da=
!!a},render:function(){var b,d,c,e;p.clearRect(0,0,t,z);if(da&&!(P<H||la))if(b=a(B+x,C+w),b=Ha(fa,b.latitude,b.longitude),!(0>=b.altitude)){d=1/xa(b.altitude);c=0.4/d;ua.x=Qa(b.azimuth)*d;ua.y=Pa(b.azimuth)*d;ea.a=c;e=ea+"";var g,f,h,j,l,m,n,r,q,k,s,u,v=[];p.beginPath();b=0;for(d=D.renderItems.length;b<d;b++){f=D.renderItems[b];r=!1;h=f.footprint;n=[];c=0;for(g=h.length-1;c<g;c+=2)n[c]=l=h[c]-B,n[c+1]=m=h[c+1]-C,r||(r=0<l&&l<t&&0<m&&m<z);if(r){h=1>f.scale?f.height*f.scale:f.height;f.minHeight&&(j=
1>f.scale?f.minHeight*f.scale:f.minHeight);l=null;c=0;for(g=n.length-3;c<g;c+=2)m=n[c],q=n[c+1],r=n[c+2],k=n[c+3],s=va(m,q,h),u=va(r,k,h),f.minHeight&&(q=va(m,q,j),k=va(r,k,j),m=q.x,q=q.y,r=k.x,k=k.y),(r-m)*(s.y-q)>(s.x-m)*(k-q)?(1===l&&p.lineTo(m,q),l=0,c||p.moveTo(m,q),p.lineTo(r,k)):(0===l&&p.lineTo(s.x,s.y),l=1,c||p.moveTo(s.x,s.y),p.lineTo(u.x,u.y));p.closePath();v.push(n)}}p.fillStyle=e;p.fill();p.globalCompositeOperation="destination-out";p.beginPath();b=0;for(d=v.length;b<d;b++){j=v[b];p.moveTo(j[0],
j[1]);c=2;for(g=j.length;c<g;c+=2)p.lineTo(j[c],j[c+1]);p.lineTo(j[0],j[1]);p.closePath()}p.fillStyle="#00ff00";p.fill();p.globalCompositeOperation="source-over"}},setDate:function(a){fa=a;Ba.render()}};ka=Ba;var sa,E,ga={MAX_HEIGHT:8,setContext:function(a){E=a},render:function(){E.clearRect(0,0,t,z);if(!(P<H||la)){var a,b,c,d,e,f,g,h,j;E.beginPath();a=0;for(b=D.renderItems.length;a<b;a++)if(c=D.renderItems[a],!(c.height>ga.MAX_HEIGHT)){j=!1;e=c.footprint;h=[];c=0;for(d=e.length-1;c<d;c+=2)h[c]=f=
e[c]-B,h[c+1]=g=e[c+1]-C,j||(j=0<f&&f<t&&0<g&&g<z);if(j){c=0;for(d=h.length-3;c<d;c+=2)j=h[c],e=h[c+1],c?E.lineTo(j,e):E.moveTo(j,e);E.closePath()}}E.fillStyle=pa;E.strokeStyle=oa;E.stroke();E.fill()}}};sa=ga;var Ca,Da=function(){var a=Ga.createElement("CANVAS");a.style.webkitTransform="translate3d(0,0,0)";a.style.imageRendering="optimizeSpeed";a.style.position="absolute";a.style.left=0;a.style.top=0;var b=a.getContext("2d");b.lineCap="round";b.lineJoin="round";b.lineWidth=1;b.mozImageSmoothingEnabled=
!1;b.webkitImageSmoothingEnabled=!1;wa.push(a);X.appendChild(a);return b},X=Ga.createElement("DIV");X.style.pointerEvents="none";X.style.position="absolute";X.style.left=0;X.style.top=0;var wa=[];ka.setContext(Da());sa.setContext(Da());A=Da();Ca={appendTo:function(a){a.appendChild(X);return X},setSize:function(a,b){for(var c=0,d=wa.length;c<d;c++)wa[c].width=a,wa[c].height=b}};var ha=this;if(window.DeviceMotionEvent){var Ea=Math.abs;window.addEventListener("devicemotion",function(a){var b;if(a=a.accelerationIncludingGravity||
a.acceleration)if(2<Ea(a.x)||2<Ea(a.y)||2<Ea(a.z)){switch(window.orientation){case -90:b=a.x;a.x=a.y;a.y=-b;break;case 90:b=a.x;a.x=-a.y;a.y=b;break;case 180:case -180:a.x*=-1,a.y*=-1}ha.setCamOffset(10*-a.x,10*-a.y);d()}})}window.addEventListener("mousemove",function(a){var b=Math.abs,c=t/2-a.x;a=z-a.y;if(2<b(c)||2<b(a))ha.setCamOffset(-c/3,-a/3),d()});this.setStyle=function(a){a=a||{};if(a.color||a.wallColor)J=T.parse(a.color||a.wallColor),I=J.setAlpha(M)+"",v=J.setLightness(0.8),oa=v.setAlpha(M)+
"",ba=J.setLightness(1.2),pa=ba.setAlpha(M)+"";a.roofColor&&(ba=T.parse(a.roofColor),pa=ba.setAlpha(M)+"");void 0!==a.shadows&&ka.enable(a.shadows);g()};this.setCamOffset=function(a,b){ma=x+a;na=z+b};this.setMaxZoom=function(a){O=a};this.setDate=function(a){ka.setDate(a)};this.appendTo=function(a){return Ca.appendTo(a)};this.loadData=function(a){D.load(a)};this.setData=function(a){D.set(a)};this.onMoveEnd=function(){g();D.update()};this.onZoomEnd=function(a){la=!1;r(a.zoom);D.update();g()};this.onZoomStart=
function(){la=!0;g()};this.setOrigin=function(a,b){B=a;C=b};this.setSize=function(a,b){t=a;z=b;x=t/2<<0;w=z/2<<0;ma=x;na=z;aa=t/(1.5/(window.devicePixelRatio||1))/xa(45)<<0;Ca.setSize(t,z);U=aa-50};this.setZoom=r;this.render=d};h.VERSION="0.1.8a";h.ATTRIBUTION='&copy; <a href="http://osmbuildings.org">OSM Buildings</a>';return h}();
OpenLayers.Layer.Buildings=OpenLayers.Class(OpenLayers.Layer,{CLASS_NAME:"OpenLayers.Layer.Buildings",name:"OSM Buildings",attribution:OSMBuildings.ATTRIBUTION,isBaseLayer:!1,alwaysInRange:!0,dxSum:0,dySum:0,initialize:function(f){f=f||{};f.projection="EPSG:900913";OpenLayers.Layer.prototype.initialize.call(this,this.name,f)},setOrigin:function(){var f=this.map.getLonLatFromPixel(new OpenLayers.Pixel(0,0)),K=this.map.resolution,u=this.maxExtent,Y=Math.round((f.lon-u.left)/K),f=Math.round((u.top-f.lat)/
K);this.osmb.setOrigin(Y,f)},setMap:function(f){this.map||OpenLayers.Layer.prototype.setMap.call(this,f);this.osmb||(this.osmb=new OSMBuildings,this.container=this.osmb.appendTo(this.div));this.osmb.setSize(this.map.size.w,this.map.size.h);this.osmb.setZoom(this.map.zoom);this.setOrigin()},removeMap:function(f){this.container.parentNode.removeChild(this.container);OpenLayers.Layer.prototype.removeMap.call(this,f)},onMapResize:function(){OpenLayers.Layer.prototype.onMapResize.call(this);this.osmb.onResize({width:this.map.size.w,
height:this.map.size.h})},moveTo:function(f,K,u){f=OpenLayers.Layer.prototype.moveTo.call(this,f,K,u);if(!u){u=parseInt(this.map.layerContainerDiv.style.left,10);var Y=parseInt(this.map.layerContainerDiv.style.top,10);this.div.style.left=-u+"px";this.div.style.top=-Y+"px"}this.setOrigin();this.dySum=this.dxSum=0;this.osmb.setCamOffset(this.dxSum,this.dySum);if(K)this.osmb.onZoomEnd({zoom:this.map.zoom});else this.osmb.onMoveEnd();return f},moveByPx:function(f,K){this.dxSum+=f;this.dySum+=K;var u=
OpenLayers.Layer.prototype.moveByPx.call(this,f,K);this.osmb.setCamOffset(this.dxSum,this.dySum);this.osmb.render();return u},setStyle:function(f){this.osmb.setStyle(f);return this},setDate:function(f){this.osmb.setDate(f);return this},load:function(f){this.osmb.loadData(f);return this},geoJSON:function(f){this.osmb.setData(f);return this}});
