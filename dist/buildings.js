(function(t){function ka(a){h=t.document.createElement("canvas");h.style.webkitTransform="translate3d(0,0,0)";h.style.position="absolute";h.style.pointerEvents="none";h.style.left=0;h.style.top=0;a.appendChild(h);d=h.getContext("2d");d.lineCap="round";d.lineJoin="round";d.lineWidth=1;try{d.mozImageSmoothingEnabled=!1}catch(c){}}function u(a,c){var b={},a=a/O,c=c/O;b[y]=0>=c?90:1<=c?-90:la*(2*ma(na(s*(1-2*c)))-ba);b[p]=360*(1===a?1:(a%1+1)%1)-180;return b}function oa(a,c){return a.replace(/\{ *([\w_]+) *\}/g,
function(a,e){return c[e]||""})}function pa(a,c){var b=new XMLHttpRequest;b.onreadystatechange=function(){4!==b.readyState||!b.status||200>b.status||299<b.status||b.responseText&&c(JSON.parse(b.responseText))};b.open("GET",a);b.send(null);return b}function I(){if(P&&!(n<J)){var a=u(A-z,B-v),c=u(A+z,B+v);K&&K.abort();K=pa(oa(P,{w:a[p],n:a[y],e:c[p],s:c[y],z:n}),qa)}}function ca(a,c,b){var b=b||[],e=a[0]?a:a.features,j,l,f;if(e){a=0;for(j=e.length;a<j;a++)ca(e[a],c,b);return b}"Feature"===a.type&&(j=
a.geometry,l=a.properties);if("Polygon"==j.type&&l.height){e=j.coordinates[0];f=[];a=0;for(j=e.length;a<j;a++)c?(f.push(e[a][1]),f.push(e[a][0])):(f.push(e[a][0]),f.push(e[a][1]));b.push([l.height,ra(f)])}return b}function da(a,c,b){for(var e,j,l=[],f,E,g,i=Q-c,d=0,k=a.length;d<k;d++){f=a[d][0];E=a[d][1];g=new Int32Array(E.length);for(var h=0,q=E.length-1;h<q;h+=2){e=E[h+1];j=ea<<c;var n=R(1,sa(0,0.5-ta(ua(va+ba*E[h]/180))/s/2));e=~~((e/360+0.5)*j);j=~~(n*j);g[h]=e;g[h+1]=j}l[d]=[R(f>>i,fa),g,b]}return l}
function ra(a){for(var c=a.length,b=-90,e=-180,j=180,l,f,d=0;d<c-1;d+=2)if(a[d+1]<j?(j=a[d+1],l=d):a[d+1]>e&&(e=a[d+1],f=d),a[d]>b)b=a[d],NI=d;b=l-NI;f-=NI;0>b&&(b+=c);0>f&&(f+=c);if("CW"===(b>f?"CW":"CCW"))return a;c=[];for(f=a.length-2;0<=f;f-=2)c.push(a[f]),c.push(a[f+1]);return c}function ga(a,c){z=a;v=c;C=~~(z/2);L=~~(v/2);F=C;G=v;h.width=z;h.height=v}function ha(a,c){A=a;B=c}function ia(a){n=a;O=ea<<n;M=1-0.3*(n-J)/(Q-J)}function wa(){S=!0;o()}function qa(a){var c,b,e,d=[],l=0,f=0;K=null;if(a&&
a.meta.z===n){e=a.meta;b=a.data;if(k&&i&&k.z===e.z){l=k.x-e.x;f=k.y-e.y;a=0;for(c=i.length;a<c;a++)d[a]=i[a][H][0]+l+","+(i[a][H][1]+f)}k=e;i=[];a=0;for(c=b.length;a<c;a++)i[a]=b[a],i[a][N]=R(i[a][N],fa),e=i[a][H][0]+","+i[a][H][1],i[a][T]=!(d&&~d.indexOf(e));ja()}}function ja(){D=0;clearInterval(U);U=setInterval(function(){D+=0.1;if(1<D){clearInterval(U);D=1;for(var a=0,c=i.length;a<c;a++)i[a][T]=0}o()},33)}function o(){var a,c,b,e;d.clearRect(0,0,z,v);if(k&&i&&!(n<J||S)){var j=V(W,M),l=V(X,M),f=
V(Y,M);d.strokeStyle=f;var h,g,o,w,x=A-C-k.x,y=B-L-k.y,q,s,m,p,r,t,u,f=0;for(h=i.length;f<h;f++){a=i[f];w=!1;c=a[H];q=new Int32Array(c.length);g=0;for(o=c.length-1;g<o;g+=2)q[g]=b=c[g]-x,q[g+1]=e=c[g+1]-y,w||(w=0<b&&b<z&&0<e&&e<v);if(w){d.fillStyle=j;g=a[T]?a[N]*D:a[N];w=Z/(Z-g);s=new Int32Array(q.length-2);m=[];g=0;for(o=q.length-3;g<o;g+=2)p=q[g],r=q[g+1],t=q[g+2],u=q[g+3],b=~~((p-F)*w+F),e=~~((r-G)*w+G),a=~~((t-F)*w+F),c=~~((u-G)*w+G),(t-p)*(e-r)>(b-p)*(u-r)?(m.length||(m.unshift(r),m.unshift(p),
m.push(b),m.push(e)),m.unshift(u),m.unshift(t),m.push(a),m.push(c)):($(m),m=[]),s[g]=b,s[g+1]=e;$(m);d.fillStyle=l;$(s,aa)}}}}function $(a,c){if(a.length){d.beginPath();d.moveTo(a[0],a[1]);for(var b=2,e=a.length;b<e;b+=2)d.lineTo(a[b],a[b+1]);d.closePath();c&&d.stroke();d.fill()}}function V(a,c){var b=a.match(/rgba?\((\d+),(\d+),(\d+)(,([\d.]+))?\)/);return"rgba("+[b[1],b[2],b[3],b[4]?c*b[5]:c].join()+")"}t.Int32Array=t.Int32Array||Array;var na=Math.exp,ta=Math.log,ua=Math.tan,ma=Math.atan,R=Math.min,
sa=Math.max,s=Math.PI,ba=s/2,va=s/4,la=180/s,y="latitude",p="longitude",N=0,H=1,T=2,z=0,v=0,C=0,L=0,A=0,B=0,n,O,K,h,d,P,aa,W="rgb(200,190,180)",X="rgb(250,240,230)",Y="rgb(145,140,135)",r,k,i,M=1,D=1,U,ea=256,J=14,Q,F=C,G=v,Z=400,fa=Z-50,S=!1,x=t.OSMBuildings=function(a){this.addTo(a)};x.prototype.VERSION="0.1a";x.prototype.render=function(){if(this.map)return o(),this};x.prototype.setStyle=function(a){if(this.map)return a=a||{},aa=void 0!==a.strokeRoofs?a.strokeRoofs:aa,W=a.wallColor||W,X=a.roofColor||
X,Y=a.strokeColor||Y,this};x.prototype.setData=function(a,c){if(this.map)return a?(r=ca(a,c),k={n:90,w:-180,s:-90,e:180,x:0,y:0,z:n},i=da(r,n,!0),ja()):(r=null,o()),this};x.prototype.loadData=function(a){if(this.map)return P=a,I(),this};(function(a){a.VERSION+="-leaflet-patch";a.addTo=function(a){function b(){var b=a._size.divideBy(2);return a._getTopLeftPoint().add(b)}this.map=a;ka(document.querySelector(".leaflet-container"));Q=a._layersMaxZoom;ga(a._size.x,a._size.y);var e=b();ha(e.x,e.y);ia(a._zoom);
var d;window.addEventListener("resize",function(){d=setTimeout(function(){clearTimeout(d);ga(a._size.x,a._size.y);o();I()},100)},!1);a.on({move:function(){var a=b();ha(a.x,a.y);o()},moveend:function(){b();var a=u(A-C,B-L),c=u(A+C,B+L);k&&(a[y]>k.n||a[p]<k.w||c[y]<k.s||c[p]>k.e)&&I()},zoomstart:wa,zoomend:function(){var b=a._zoom;S=!1;ia(b);r?(i=da(r,n),o()):I()}});a.attributionControl.addAttribution('Buildings &copy; <a href="http://osmbuildings.org">OSM Buildings</a>');return this};a.removeFrom=
function(a){a.attributionControl.removeAttribution('Buildings &copy; <a href="http://osmbuildings.org">OSM Buildings</a>');a.off({});h.parentNode.removeChild(h);this.map=null;return this}})(x.prototype)})(this);
