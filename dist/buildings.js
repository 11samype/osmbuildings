(function(v){function $(a){g=v.document.createElement("canvas");g.style.webkitTransform="translate3d(0,0,0)";g.style.position="absolute";g.style.pointerEvents="none";g.style.left=0;g.style.top=0;a.appendChild(g);f=g.getContext("2d");f.lineWidth=1;f.lineCap="round";f.lineJoin="round";try{f.mozImageSmoothingEnabled=!1}catch(b){}}function U(a){a=a||{};J=a.strokeRoofs||J;K=a.wallColor||K;L=a.roofColor||L;M=a.strokeColor||M}function w(a,b){var c={},a=a/N,b=b/N;c[l]=0>=b?90:1<=b?-90:aa*(2*ba(ca(O*(1-2*
b)))-da);c[r]=360*(1===a?1:(a%1+1)%1)-180;return c}function ea(a,b){return a.replace(/\{ *([\w_]+) *\}/g,function(a,d){return b[d]||""})}function fa(a,b){var c=new XMLHttpRequest;c.onreadystatechange=function(){4!==c.readyState||!c.status||200>c.status||299<c.status||c.responseText&&b(JSON.parse(c.responseText))};c.open("GET",a);c.send(null);return c}function n(){if(!(t<F)){var a=w(x-u,y-j),b=w(x+u,y+j);o&&o.abort();o=fa(ea(V,{w:a[r],n:a[l],e:b[r],s:b[l],z:t}),ga)}}function W(a,b){u=a;j=b;z=~~(u/
2);G=~~(j/2);B=z;C=j;g.width=u;g.height=j}function X(a,b){x=a;y=b}function Y(a){t=a;N=ha<<t;H=1-0.3*(t-F)/(Z-F)}function ia(){P=!0;m()}function ga(a){var b,c,d,f=[],g=0,j=0;o=null;if(a&&a.meta.z===t){d=a.meta;c=a.data;if(k&&h&&k.z===d.z){g=k.x-d.x;j=k.y-d.y;a=0;for(b=h.length;a<b;a++)f[a]=h[a][1][0]+g+","+(h[a][1][1]+j)}k=d;h=[];a=0;for(b=c.length;a<b;a++)h[a]=c[a],h[a][0]=ja(h[a][0],ka),d=h[a][1][0]+","+h[a][1][1],f&&-1<~~f.indexOf(d)&&(h[a][2]=1);la()}}function la(){A=0;clearInterval(Q);Q=setInterval(function(){A+=
0.1;if(1<A){clearInterval(Q);A=1;for(var a=0,b=h.length;a<b;a++)delete h[a][2]}m()},33)}function m(){var a,b,c,d;f.clearRect(0,0,u,j);if(!(t<F||P)){var g=R(K,H),s=R(L,H),l=R(M,H);f.strokeStyle=l;var r,e,m,p,v=x-z-k.x,w=y-G-k.y,q,n,i,D,E,o,I,l=0;for(r=h.length;l<r;l++){a=h[l];p=!1;b=a[1];q=new Int32Array(b.length);e=0;for(m=b.length-1;e<m;e+=2)q[e]=c=b[e]-v,q[e+1]=d=b[e+1]-w,p||(p=0<c&&c<u&&0<d&&d<j);if(p){f.fillStyle=g;e=a[2]?a[0]:a[0]*A;p=S/(S-e);n=new Int32Array(q.length-2);i=[];e=0;for(m=q.length-
1-2;e<m;e+=2)D=q[e],E=q[e+1],o=q[e+2],I=q[e+3],c=~~((D-B)*p+B),d=~~((E-C)*p+C),a=~~((o-B)*p+B),b=~~((I-C)*p+C),(o-D)*(d-E)>(c-D)*(I-E)?(i.length||(i.unshift(E),i.unshift(D),i.push(c),i.push(d)),i.unshift(I),i.unshift(o),i.push(a),i.push(b)):(T(i),i=[]),n[e]=c,n[e+1]=d;T(i);f.fillStyle=s;T(n,J)}}}}function T(a,b){f.beginPath();f.moveTo(a[0],a[1]);for(var c=2,d=a.length;c<d;c+=2)f.lineTo(a[c],a[c+1]);f.closePath();b&&f.stroke();f.fill()}function R(a,b){var c=a.match(/rgba?\((\d+),(\d+),(\d+)(,([\d.]+))?\)/);
return"rgba("+[c[1],c[2],c[3],c[4]?b*c[5]:b].join()+")"}v.Int32Array=v.Int32Array||Array;var ca=Math.exp,ba=Math.atan,ja=Math.min,O=Math.PI,da=O/2,aa=180/O,l="latitude",r="longitude",u=0,j=0,z=0,G=0,x=0,y=0,t,N,o,g,f,V,J,K="rgb(200,190,180)",L="rgb(250,240,230)",M="rgb(145,140,135)",k,h,H=1,A=1,Q,ha=256,F=14,Z,B=z,C=j,S=400,ka=S-50,P=!1,s=v.OSMBuildings=function(a,b){V=a;U(b)};s.prototype.version="0.1a";s.prototype.render=m;s.prototype.setStyle=U;s.prototype.version+="-leaflet-patch";s.prototype.addTo=
function(a){function b(){var b=a._size.divideBy(2);return a._getTopLeftPoint().add(b)}$(document.querySelector(".leaflet-control-container"));Z=a._layersMaxZoom;W(a._size.x,a._size.y);var c=b();X(c.x,c.y);Y(a._zoom);var d;window.addEventListener("resize",function(){d=setTimeout(function(){clearTimeout(d);W(a._size.x,a._size.y);m();n()},100)},!1);a.on({move:function(){var a=b();X(a.x,a.y);m()},moveend:function(){b();var a=w(x-z,y-G),c=w(x+z,y+G);k&&(a[l]>k.n||a[r]<k.w||c[l]<k.s||c[r]>k.e)&&n()},zoomstart:ia,
zoomend:function(){var b=a._zoom;P=!1;Y(b);n()}});a.attributionControl.addAttribution('&copy; <a href="http://osmbuildings.org">OSM Buildings</a>');n()}})(this);
