(function(v){function da(a){g=v.document.createElement("canvas");g.style.webkitTransform="translate3d(0,0,0)";g.style.position="absolute";g.style.pointerEvents="none";g.style.left=0;g.style.top=0;a.appendChild(g);d=g.getContext("2d");d.lineCap="round";d.lineJoin="round";d.lineWidth=1;try{d.mozImageSmoothingEnabled=!1}catch(b){}}function Y(a){a=a||{};M=void 0!==a.strokeRoofs?a.strokeRoofs:M;N=a.wallColor||N;O=a.roofColor||O;P=a.strokeColor||P}function l(a,b){var c={},a=a/Q,b=b/Q;c[r]=0>=b?90:1<=b?
-90:ea*(2*fa(ga(R*(1-2*b)))-ha);c[k]=360*(1===a?1:(a%1+1)%1)-180;return c}function ia(a,b){return a.replace(/\{ *([\w_]+) *\}/g,function(a,e){return b[e]||""})}function ja(a,b){var c=new XMLHttpRequest;c.onreadystatechange=function(){4!==c.readyState||!c.status||200>c.status||299<c.status||c.responseText&&b(JSON.parse(c.responseText))};c.open("GET",a);c.send(null);return c}function m(){if(!(s<G)){var a=l(w-t,x-n),b=l(w+t,x+n);o&&o.abort();o=ja(ia(Z,{w:a[k],n:a[r],e:b[k],s:b[r],z:s}),ka)}}function $(a,
b){t=a;n=b;y=~~(t/2);H=~~(n/2);A=y;B=n;g.width=t;g.height=n}function aa(a,b){w=a;x=b}function ba(a){s=a;Q=la<<s;I=1-0.3*(s-G)/(ca-G)}function ma(){S=!0;u()}function ka(a){var b,c,e,d=[],J=0,g=0;o=null;if(a&&a.meta.z===s){e=a.meta;c=a.data;if(i&&h&&i.z===e.z){J=i.x-e.x;g=i.y-e.y;a=0;for(b=h.length;a<b;a++)d[a]=h[a][D][0]+J+","+(h[a][D][1]+g)}i=e;h=[];a=0;for(b=c.length;a<b;a++)h[a]=c[a],h[a][K]=na(h[a][K],oa),e=h[a][D][0]+","+h[a][D][1],h[a][T]=!(d&&~d.indexOf(e));pa()}}function pa(){z=0;clearInterval(U);
U=setInterval(function(){z+=0.1;if(1<z){clearInterval(U);z=1;for(var a=0,b=h.length;a<b;a++)h[a][T]=0}u()},33)}function u(){var a,b,c,e;d.clearRect(0,0,t,n);if(i&&!h&&!(s<G||S)){var g=V(N,I),J=V(O,I),C=V(P,I);d.strokeStyle=C;var r,f,k,p,u=w-y-i.x,v=x-H-i.y,q,l,j,E,F,m,o,C=0;for(r=h.length;C<r;C++){a=h[C];p=!1;b=a[D];q=new Int32Array(b.length);f=0;for(k=b.length-1;f<k;f+=2)q[f]=c=b[f]-u,q[f+1]=e=b[f+1]-v,p||(p=0<c&&c<t&&0<e&&e<n);if(p){d.fillStyle=g;f=a[T]?a[K]*z:a[K];p=W/(W-f);l=new Int32Array(q.length-
2);j=[];f=0;for(k=q.length-1-2;f<k;f+=2)E=q[f],F=q[f+1],m=q[f+2],o=q[f+3],c=~~((E-A)*p+A),e=~~((F-B)*p+B),a=~~((m-A)*p+A),b=~~((o-B)*p+B),(m-E)*(e-F)>(c-E)*(o-F)?(j.length||(j.unshift(F),j.unshift(E),j.push(c),j.push(e)),j.unshift(o),j.unshift(m),j.push(a),j.push(b)):(X(j),j=[]),l[f]=c,l[f+1]=e;X(j);d.fillStyle=J;X(l,M)}}}}function X(a,b){d.beginPath();d.moveTo(a[0],a[1]);for(var c=2,e=a.length;c<e;c+=2)d.lineTo(a[c],a[c+1]);d.closePath();b&&d.stroke();d.fill()}function V(a,b){var c=a.match(/rgba?\((\d+),(\d+),(\d+)(,([\d.]+))?\)/);
return"rgba("+[c[1],c[2],c[3],c[4]?b*c[5]:b].join()+")"}v.Int32Array=v.Int32Array||Array;var ga=Math.exp,fa=Math.atan,na=Math.min,R=Math.PI,ha=R/2,ea=180/R,r="latitude",k="longitude",K=0,D=1,T=2,t=0,n=0,y=0,H=0,w=0,x=0,s,Q,o,g,d,Z,M,N="rgb(200,190,180)",O="rgb(250,240,230)",P="rgb(145,140,135)",i,h,I=1,z=1,U,la=256,G=14,ca,A=y,B=n,W=400,oa=W-50,S=!1,L=v.OSMBuildings=function(a,b){Z=a;Y(b)};L.prototype.version="0.1a";L.prototype.render=u;L.prototype.setStyle=Y;(function(a){a.version+="-leaflet-patch";
a.addTo=function(b){function c(){var a=b._size.divideBy(2);return b._getTopLeftPoint().add(a)}a.map=b;da(document.querySelector(".leaflet-control-container"));ca=b._layersMaxZoom;$(b._size.x,b._size.y);var e=c();aa(e.x,e.y);ba(b._zoom);var d;window.addEventListener("resize",function(){d=setTimeout(function(){clearTimeout(d);$(b._size.x,b._size.y);u();m()},100)},!1);b.on({move:function(){var a=c();aa(a.x,a.y);u()},moveend:function(){c();var a=l(w-y,x-H),b=l(w+y,x+H);i&&(a[r]>i.n||a[k]<i.w||b[r]<i.s||
b[k]>i.e)&&m()},zoomstart:ma,zoomend:function(){var a=b._zoom;S=!1;ba(a);m()}});b.attributionControl.addAttribution('Buildings &copy; <a href="http://osmbuildings.org">OSM Buildings</a>');m()};a.removeFrom=function(b){b.attributionControl.removeAttribution('Buildings &copy; <a href="http://osmbuildings.org">OSM Buildings</a>');b.off({});g.parentNode.removeChild(g);a.map=null}})(L.prototype)})(this);
