(function(t){function qa(a){l=t.document.createElement("canvas");l.style.webkitTransform="translate3d(0,0,0)";l.style.position="absolute";l.style.pointerEvents="none";l.style.left=0;l.style.top=0;a.appendChild(l);q=l.getContext("2d");q.lineCap="round";q.lineJoin="round";q.lineWidth=1;try{q.mozImageSmoothingEnabled=!1}catch(c){}}function O(a,c){var b={},a=a/W,c=c/W;b[z]=0>=c?90:1<=c?-90:ra*(2*sa(ta(A*(1-2*c)))-fa);b[K]=360*(1===a?1:(a%1+1)%1)-180;return b}function ua(a,c){return a.replace(/\{ *([\w_]+) *\}/g,
function(a,d){return c[d]||""})}function va(a,c){var b=new XMLHttpRequest;b.onreadystatechange=function(){4!==b.readyState||!b.status||200>b.status||299<b.status||b.responseText&&c(JSON.parse(b.responseText))};b.open("GET",a);b.send(null);return b}function P(){if(X&&!(w<Q)){var a=O(G-u,H-Y),c=O(G+B+u,H+x+Y);R&&R.abort();R=va(ua(X,{w:a[K],n:a[z],e:c[K],s:c[z],z:w}),wa)}}function ga(a,c,b){var b=b||[],d=a[0]?a:a.features,f,k,e,i=c?1:0,g=c?0:1;if(d){a=0;for(f=d.length;a<f;a++)ga(d[a],c,b);return b}"Feature"===
a.type&&(f=a.geometry,k=a.properties);if("Polygon"==f.type){d=f.coordinates[0];c=[];a=e=0;for(f=d.length;a<f;a++)c.push(d[a][i]),c.push(d[a][g]),e+=d[a][2]||0;if(e){i=[];i[C]=~~(e/d.length);var g=y,h;a=c.length;f=-90;d=-180;e=180;for(var m,o,j=0;j<a-1;j+=2)if(c[j+1]<e?(e=c[j+1],m=j):c[j+1]>d&&(d=c[j+1],h=j),c[j]>f)f=c[j],o=j;m-=o;h-=o;0>m&&(m+=a);0>h&&(h+=a);if("CW"===(m>h?"CW":"CCW"))h=c;else{h=[];for(o=c.length-2;0<=o;o-=2)h.push(c[o]),h.push(c[o+1])}i[g]=h;k.color&&(i[D]=[k.color,Z(k.color,0.2)]);
b.push(i)}}return b}function ha(a,c,b){var d,f,k=[],e,i,g,h,m,o,j,n=$-c;e=0;for(i=a.length;e<i;e++){m=a[e];o=m[y];j=new Int32Array(o.length);g=0;for(h=o.length-1;g<h;g+=2){d=o[g+1];f=ia<<c;var l=S(1,ja(0,0.5-xa(ya(za+fa*o[g]/180))/A/2));d=~~((d/360+0.5)*f);f=~~(l*f);j[g]=d;j[g+1]=f}k[e]=[];k[e][C]=S(m[C]>>n,ka);k[e][y]=j;k[e][D]=m[D];k[e][T]=b}return k}function M(a,c){var b=a.match(/rgba?\((\d+),(\d+),(\d+)(,([\d.]+))?\)/);return"rgba("+[b[1],b[2],b[3],b[4]?c*b[5]:c].join()+")"}function aa(a,c,b){0>
b&&(b+=1);1<b&&(b-=1);return b<1/6?a+6*(c-a)*b:0.5>b?c:b<2/3?a+6*(c-a)*(2/3-b):a}function Z(a,c){var b,d,f,k=a.match(/rgba?\((\d+),(\d+),(\d+)(,([\d.]+))?\)/);b=k[1];d=k[2];var e=k[3];b/=255;d/=255;var e=e/255,i=Math.max(b,d,e),g=Math.min(b,d,e),h;f=(i+g)/2;var m;if(i==g)h=g=0;else{m=i-g;g=0.5<f?m/(2-i-g):m/(i+g);switch(i){case b:h=(d-e)/m+(d<e?6:0);break;case d:h=(e-b)/m+2;break;case e:h=(b-d)/m+4}h/=6}b=h;d=g;f=S(1,ja(0,f+c));0==d?f=d=b=f:(e=0.5>f?f*(1+d):f+d-f*d,i=2*f-e,f=aa(i,e,b+1/3),d=aa(i,
e,b),b=aa(i,e,b-1/3));a={r:~~(255*f),g:~~(255*d),b:~~(255*b)};return"rgba("+[a.r,a.g,a.b,k[4]?k[5]:1].join()+")"}function la(a,c){B=a;x=c;u=~~(B/2);Y=~~(x/2);E=u;F=x;l.width=B;l.height=x}function ma(a,c){G=a;H=c}function na(a){w=a;W=ia<<w;I=1-0.3*(w-Q)/($-Q)}function Aa(){ba=!0;p()}function wa(a){var c,b,d,f=[],k=0,e=0;R=null;if(a&&a.meta.z===w){d=a.meta;b=a.data;if(r&&n&&r.z===d.z){k=r.x-d.x;e=r.y-d.y;a=0;for(c=n.length;a<c;a++)f[a]=n[a][y][0]+k+","+(n[a][y][1]+e)}r=d;n=[];a=0;for(c=b.length;a<c;a++)n[a]=
b[a],n[a][C]=S(n[a][C],ka),d=n[a][y][0]+","+n[a][y][1],n[a][T]=!(f&&~f.indexOf(d));oa()}}function oa(){J=0;clearInterval(ca);ca=setInterval(function(){J+=0.1;if(1<J){clearInterval(ca);J=1;for(var a=0,c=n.length;a<c;a++)n[a][T]=0}p()},33)}function p(){var a,c,b,d;q.clearRect(0,0,B,x);if(r&&n&&!(w<Q||ba)){var f,k,e,i,g,h,m=G-r.x,o=H-r.y,j,l,s,p,t,u,v,z=M(U,I),A=M(pa,I);V&&(q.strokeStyle=M(Ba,I));f=0;for(k=n.length;f<k;f++){g=n[f];d=!1;a=g[y];j=new Int32Array(a.length);e=0;for(i=a.length-1;e<i;e+=2)j[e]=
c=a[e]-m,j[e+1]=b=a[e+1]-o,d||(d=0<c&&c<B&&0<b&&b<x);if(d){q.fillStyle=g[D]?M(g[D][0],I):z;e=g[T]?g[C]*J:g[C];h=da/(da-e);l=new Int32Array(j.length-2);s=[];e=0;for(i=j.length-3;e<i;e+=2)p=j[e],t=j[e+1],u=j[e+2],v=j[e+3],b=~~((p-E)*h+E),d=~~((t-F)*h+F),a=~~((u-E)*h+E),c=~~((v-F)*h+F),(u-p)*(d-t)>(b-p)*(v-t)?(s.length||(s.unshift(t),s.unshift(p),s.push(b),s.push(d)),s.unshift(v),s.unshift(u),s.push(a),s.push(c)):(ea(s),s=[]),l[e]=b,l[e+1]=d;ea(s);q.fillStyle=g[D]?M(g[D][1],I):A;ea(l,V)}}}}function ea(a,
c){if(a.length){q.beginPath();q.moveTo(a[0],a[1]);for(var b=2,d=a.length;b<d;b+=2)q.lineTo(a[b],a[b+1]);q.closePath();c&&q.stroke();q.fill()}}t.Int32Array=t.Int32Array||t.Array;var ta=Math.exp,xa=Math.log,ya=Math.tan,sa=Math.atan,S=Math.min,ja=Math.max,A=Math.PI,fa=A/2,za=A/4,ra=180/A,z="latitude",K="longitude",C=0,y=1,D=2,T=3,B=0,x=0,u=0,Y=0,G=0,H=0,w,W,R,l,q,X,V,U="rgb(200,190,180)",pa=Z(U,0.2),Ba="rgb(145,140,135)",N,r,n,I=1,J=1,ca,ia=256,Q=14,$,E,F,da=400,ka=da-50,ba=!1,v=t.OSMBuildings=function(a){this.addTo(a)};
v.prototype.VERSION="0.1a";v.prototype.render=function(){if(this.map)return p(),this};v.prototype.setStyle=function(a){if(this.map)return a=a||{},V=void 0!==a.strokeRoofs?a.strokeRoofs:V,a.fillColor&&(U=a.fillColor,pa=Z(U,0.2)),p(),this};v.prototype.setData=function(a,c){if(this.map)return a?(N=ga(a,c),r={n:90,w:-180,s:-90,e:180,x:0,y:0,z:w},n=ha(N,w,!0),oa()):(N=null,p()),this};v.prototype.loadData=function(a){if(this.map)return X=a,P(),this};(function(a){var c,b,d,f;a.VERSION+="-leaflet";a.addTo=
function(a){a.addLayer(this);return this};a.onAdd=function(a){this.map=a;qa(a._panes.overlayPane);$=a._layersMaxZoom;la(a._size.x,a._size.y);var e=a.getPixelOrigin();ma(e.x,e.y);na(a._zoom);var i;t.addEventListener("resize",function(){i=setTimeout(function(){clearTimeout(i);la(a._size.x,a._size.y);p();P()},100)},!1);var g=0,h=0;c=function(){var b=L.DomUtil.getPosition(a._mapPane);E=u-(b.x-g);F=x-(b.y-h);p()};b=function(){var b=L.DomUtil.getPosition(a._mapPane);g=b.x;h=b.y;l.style.left=-b.x+"px";l.style.top=
-b.y+"px";E=u;F=x;var c=a.getPixelOrigin();ma(c.x-b.x,c.y-b.y);b=O(G,H);c=O(G+B,H+x);r&&(b[z]>r.n||b[K]<r.w||c[z]<r.s||c[K]>r.e)&&P();p()};d=Aa;f=function(){var b=a._zoom;ba=!1;na(b);N?(n=ha(N,w),p()):P()};a.on({move:c,moveend:b,zoomstart:d,zoomend:f});a.options.zoomAnimation&&(l.className="leaflet-zoom-animated");a.attributionControl.addAttribution('Buildings &copy; <a href="http://osmbuildings.org">OSM Buildings</a>');p()};a.onRemove=function(a){a.attributionControl.removeAttribution('Buildings &copy; <a href="http://osmbuildings.org">OSM Buildings</a>');
a.off({move:c,moveend:b,zoomstart:d,zoomend:f});l.parentNode.removeChild(l);this.map=null}})(v.prototype)})(this);
