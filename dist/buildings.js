(function(v){function aa(a){g=v.document.createElement("canvas");g.style.webkitTransform="translate3d(0,0,0)";g.style.position="absolute";g.style.pointerEvents="none";g.style.left=0;g.style.top=0;a.appendChild(g);d=g.getContext("2d");d.lineCap="round";d.lineJoin="round";d.lineWidth=1;try{d.mozImageSmoothingEnabled=!1}catch(b){}}function V(a){a=a||{};K=void 0!==a.strokeRoofs?a.strokeRoofs:K;L=a.wallColor||L;M=a.roofColor||M;N=a.strokeColor||N}function l(a,b){var c={},a=a/O,b=b/O;c[r]=0>=b?90:1<=b?
-90:ba*(2*ca(da(P*(1-2*b)))-ea);c[k]=360*(1===a?1:(a%1+1)%1)-180;return c}function fa(a,b){return a.replace(/\{ *([\w_]+) *\}/g,function(a,e){return b[e]||""})}function ga(a,b){var c=new XMLHttpRequest;c.onreadystatechange=function(){4!==c.readyState||!c.status||200>c.status||299<c.status||c.responseText&&b(JSON.parse(c.responseText))};c.open("GET",a);c.send(null);return c}function m(){if(!(s<F)){var a=l(w-t,x-n),b=l(w+t,x+n);o&&o.abort();o=ga(fa(W,{w:a[k],n:a[r],e:b[k],s:b[r],z:s}),ha)}}function X(a,
b){t=a;n=b;y=~~(t/2);G=~~(n/2);A=y;B=n;g.width=t;g.height=n}function Y(a,b){w=a;x=b}function Z(a){s=a;O=ia<<s;H=1-0.3*(s-F)/($-F)}function ja(){Q=!0;u()}function ha(a){var b,c,e,d=[],I=0,g=0;o=null;if(a&&a.meta.z===s){e=a.meta;c=a.data;if(j&&h&&j.z===e.z){I=j.x-e.x;g=j.y-e.y;a=0;for(b=h.length;a<b;a++)d[a]=h[a][1][0]+I+","+(h[a][1][1]+g)}j=e;h=[];a=0;for(b=c.length;a<b;a++)h[a]=c[a],h[a][0]=ka(h[a][0],la),e=h[a][1][0]+","+h[a][1][1],d&&-1<~~d.indexOf(e)&&(h[a][2]=1);ma()}}function ma(){z=0;clearInterval(R);
R=setInterval(function(){z+=0.1;if(1<z){clearInterval(R);z=1;for(var a=0,b=h.length;a<b;a++)delete h[a][2]}u()},33)}function u(){var a,b,c,e;d.clearRect(0,0,t,n);if(!(s<F||Q)){var g=S(L,H),I=S(M,H),C=S(N,H);d.strokeStyle=C;var r,f,k,p,u=w-y-j.x,v=x-G-j.y,q,l,i,D,E,m,o,C=0;for(r=h.length;C<r;C++){a=h[C];p=!1;b=a[1];q=new Int32Array(b.length);f=0;for(k=b.length-1;f<k;f+=2)q[f]=c=b[f]-u,q[f+1]=e=b[f+1]-v,p||(p=0<c&&c<t&&0<e&&e<n);if(p){d.fillStyle=g;f=a[2]?a[0]:a[0]*z;p=T/(T-f);l=new Int32Array(q.length-
2);i=[];f=0;for(k=q.length-1-2;f<k;f+=2)D=q[f],E=q[f+1],m=q[f+2],o=q[f+3],c=~~((D-A)*p+A),e=~~((E-B)*p+B),a=~~((m-A)*p+A),b=~~((o-B)*p+B),(m-D)*(e-E)>(c-D)*(o-E)?(i.length||(i.unshift(E),i.unshift(D),i.push(c),i.push(e)),i.unshift(o),i.unshift(m),i.push(a),i.push(b)):(U(i),i=[]),l[f]=c,l[f+1]=e;U(i);d.fillStyle=I;U(l,K)}}}}function U(a,b){d.beginPath();d.moveTo(a[0],a[1]);for(var c=2,e=a.length;c<e;c+=2)d.lineTo(a[c],a[c+1]);d.closePath();b&&d.stroke();d.fill()}function S(a,b){var c=a.match(/rgba?\((\d+),(\d+),(\d+)(,([\d.]+))?\)/);
return"rgba("+[c[1],c[2],c[3],c[4]?b*c[5]:b].join()+")"}v.Int32Array=v.Int32Array||Array;var da=Math.exp,ca=Math.atan,ka=Math.min,P=Math.PI,ea=P/2,ba=180/P,r="latitude",k="longitude",t=0,n=0,y=0,G=0,w=0,x=0,s,O,o,g,d,W,K,L="rgb(200,190,180)",M="rgb(250,240,230)",N="rgb(145,140,135)",j,h,H=1,z=1,R,ia=256,F=14,$,A=y,B=n,T=400,la=T-50,Q=!1,J=v.OSMBuildings=function(a,b){W=a;V(b)};J.prototype.version="0.1a";J.prototype.render=u;J.prototype.setStyle=V;(function(a){a.version+="-leaflet-patch";a.addTo=function(b){function c(){var a=
b._size.divideBy(2);return b._getTopLeftPoint().add(a)}a.map=b;aa(document.querySelector(".leaflet-control-container"));$=b._layersMaxZoom;X(b._size.x,b._size.y);var e=c();Y(e.x,e.y);Z(b._zoom);var d;window.addEventListener("resize",function(){d=setTimeout(function(){clearTimeout(d);X(b._size.x,b._size.y);u();m()},100)},!1);b.on({move:function(){var a=c();Y(a.x,a.y);u()},moveend:function(){c();var a=l(w-y,x-G),b=l(w+y,x+G);j&&(a[r]>j.n||a[k]<j.w||b[r]<j.s||b[k]>j.e)&&m()},zoomstart:ja,zoomend:function(){var a=
b._zoom;Q=!1;Z(a);m()},viewreset:function(){console.log("VIEWRESET")}});b.attributionControl.addAttribution('Buildings &copy; <a href="http://osmbuildings.org">OSM Buildings</a>');m()};a.removeFrom=function(b){b.attributionControl.removeAttribution('Buildings &copy; <a href="http://osmbuildings.org">OSM Buildings</a>');b.off({});g.parentNode.removeChild(g);a.map=null}})(J.prototype)})(this);
